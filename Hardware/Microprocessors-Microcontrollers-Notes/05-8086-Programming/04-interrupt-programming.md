# Chapter 5.4: Interrupt Programming

## ğŸ“š Chapter Overview

This chapter covers interrupt programming in 8086, including BIOS and DOS interrupts, interrupt vector table, and writing custom interrupt service routines. Understanding interrupts is crucial for system-level programming.

---

## ğŸ¯ Learning Objectives

After completing this chapter, you will be able to:
- Understand the interrupt mechanism in 8086
- Use DOS INT 21H services
- Use BIOS interrupts for I/O
- Write custom interrupt service routines
- Handle hardware and software interrupts

---

## 1. Interrupt Fundamentals

### 1.1 Interrupt Mechanism

```
INTERRUPT CONCEPT:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   INTERRUPT = Temporary suspension of main program to          â”‚
â”‚               service a higher priority request                 â”‚
â”‚                                                                  â”‚
â”‚   TYPES OF INTERRUPTS:                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   1. Hardware Interrupts (External)                      â”‚  â”‚
â”‚   â”‚      â€¢ INTR - Maskable interrupt                        â”‚  â”‚
â”‚   â”‚      â€¢ NMI  - Non-maskable interrupt                    â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   2. Software Interrupts                                 â”‚  â”‚
â”‚   â”‚      â€¢ INT n - Explicit interrupt instruction           â”‚  â”‚
â”‚   â”‚      â€¢ INT 21H, INT 10H, etc.                           â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   3. Processor Exceptions                                â”‚  â”‚
â”‚   â”‚      â€¢ Divide by zero (INT 0)                           â”‚  â”‚
â”‚   â”‚      â€¢ Single step (INT 1)                              â”‚  â”‚
â”‚   â”‚      â€¢ Breakpoint (INT 3)                               â”‚  â”‚
â”‚   â”‚      â€¢ Overflow (INT 4 - INTO)                          â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   INTERRUPT PROCESSING STEPS:                                    â”‚
â”‚   1. Complete current instruction                               â”‚
â”‚   2. Push FLAGS onto stack                                      â”‚
â”‚   3. Clear IF and TF flags                                      â”‚
â”‚   4. Push CS onto stack                                         â”‚
â”‚   5. Push IP onto stack                                         â”‚
â”‚   6. Load new CS:IP from Interrupt Vector Table                â”‚
â”‚   7. Execute ISR                                                â”‚
â”‚   8. IRET restores IP, CS, FLAGS                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Interrupt Vector Table

```
INTERRUPT VECTOR TABLE (IVT):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   Location: 00000H to 003FFH (first 1KB of memory)             â”‚
â”‚   Size: 256 vectors Ã— 4 bytes = 1024 bytes                     â”‚
â”‚                                                                  â”‚
â”‚   VECTOR FORMAT (4 bytes each):                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚   Offset Low   (IP low byte)   â”‚  +0   â”‚                   â”‚
â”‚   â”‚   Offset High  (IP high byte)  â”‚  +1   â”‚                   â”‚
â”‚   â”‚   Segment Low  (CS low byte)   â”‚  +2   â”‚                   â”‚
â”‚   â”‚   Segment High (CS high byte)  â”‚  +3   â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚   VECTOR ADDRESS CALCULATION:                                    â”‚
â”‚   Vector Address = Interrupt Number Ã— 4                         â”‚
â”‚                                                                  â”‚
â”‚   Example: INT 21H                                              â”‚
â”‚   Vector Address = 21H Ã— 4 = 84H                               â”‚
â”‚   Address 0084H-0087H contains CS:IP of INT 21H handler        â”‚
â”‚                                                                  â”‚
â”‚   IMPORTANT VECTORS:                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ INT      â”‚ Description                                  â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚ 00H      â”‚ Divide by zero                               â”‚  â”‚
â”‚   â”‚ 01H      â”‚ Single step (debug)                          â”‚  â”‚
â”‚   â”‚ 02H      â”‚ NMI                                          â”‚  â”‚
â”‚   â”‚ 03H      â”‚ Breakpoint                                   â”‚  â”‚
â”‚   â”‚ 04H      â”‚ Overflow                                     â”‚  â”‚
â”‚   â”‚ 05H      â”‚ Print screen                                 â”‚  â”‚
â”‚   â”‚ 08H      â”‚ Timer tick (IRQ0)                            â”‚  â”‚
â”‚   â”‚ 09H      â”‚ Keyboard (IRQ1)                              â”‚  â”‚
â”‚   â”‚ 10H      â”‚ Video BIOS                                   â”‚  â”‚
â”‚   â”‚ 13H      â”‚ Disk BIOS                                    â”‚  â”‚
â”‚   â”‚ 14H      â”‚ Serial port BIOS                             â”‚  â”‚
â”‚   â”‚ 16H      â”‚ Keyboard BIOS                                â”‚  â”‚
â”‚   â”‚ 17H      â”‚ Printer BIOS                                 â”‚  â”‚
â”‚   â”‚ 1AH      â”‚ Time BIOS                                    â”‚  â”‚
â”‚   â”‚ 21H      â”‚ DOS services                                 â”‚  â”‚
â”‚   â”‚ 33H      â”‚ Mouse driver                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. DOS Interrupts (INT 21H)

### 2.1 Character I/O Functions

```
DOS INT 21H - CHARACTER I/O:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 01H - Read Character with Echo                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 01H                                           â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AL = character read (echoed to screen)              â”‚  â”‚
â”‚   â”‚   ; Waits for input, Ctrl+C check                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 02H - Display Character                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 02H                                           â”‚  â”‚
â”‚   â”‚   MOV DL, 'A'      ; Character to display              â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 06H - Direct Console I/O                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   ; OUTPUT:                                              â”‚  â”‚
â”‚   â”‚   MOV AH, 06H                                           â”‚  â”‚
â”‚   â”‚   MOV DL, char     ; char â‰  0FFH                        â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   ; INPUT (no wait):                                     â”‚  â”‚
â”‚   â”‚   MOV AH, 06H                                           â”‚  â”‚
â”‚   â”‚   MOV DL, 0FFH     ; Request input                      â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; ZF=1: no char, ZF=0: AL=char                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 07H - Direct Input (No Echo, No Ctrl+C)              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 07H                                           â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AL = character (no echo, waits)                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 08H - Read Character (No Echo)                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 08H                                           â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AL = character (no echo, Ctrl+C check)              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 String I/O Functions

```
DOS INT 21H - STRING I/O:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 09H - Display String                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   .DATA                                                 â”‚  â”‚
â”‚   â”‚   MSG DB 'Hello World!$'     ; Must end with $          â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   .CODE                                                 â”‚  â”‚
â”‚   â”‚   MOV AH, 09H                                           â”‚  â”‚
â”‚   â”‚   LEA DX, MSG               ; or MOV DX, OFFSET MSG    â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 0AH - Buffered String Input                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   .DATA                                                 â”‚  â”‚
â”‚   â”‚   BUFFER DB 81              ; Max chars (including CR)  â”‚  â”‚
â”‚   â”‚          DB ?               ; Actual count (filled)     â”‚  â”‚
â”‚   â”‚          DB 81 DUP(?)       ; Input buffer              â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   .CODE                                                 â”‚  â”‚
â”‚   â”‚   MOV AH, 0AH                                           â”‚  â”‚
â”‚   â”‚   LEA DX, BUFFER                                        â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; BUFFER+1 = number of chars entered                  â”‚  â”‚
â”‚   â”‚   ; BUFFER+2 onwards = the string                       â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   Buffer Structure:                                     â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚   â”‚ Max â”‚Countâ”‚  Input characters...    â”‚  0DH    â”‚   â”‚  â”‚
â”‚   â”‚   â”‚ 81  â”‚  n  â”‚  'H' 'e' 'l' 'l' 'o'   â”‚  (CR)   â”‚   â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚   byte 0  byte 1    bytes 2 to n+1        byte n+2     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 File Operations

```
DOS INT 21H - FILE FUNCTIONS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 3CH - Create File                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 3CH                                           â”‚  â”‚
â”‚   â”‚   MOV CX, 0           ; Attribute (0=normal)            â”‚  â”‚
â”‚   â”‚   LEA DX, FILENAME    ; ASCIIZ filename                 â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AX = file handle if CF=0, error code if CF=1       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 3DH - Open File                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 3DH                                           â”‚  â”‚
â”‚   â”‚   MOV AL, 0           ; 0=read, 1=write, 2=read/write  â”‚  â”‚
â”‚   â”‚   LEA DX, FILENAME                                      â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AX = file handle                                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 3EH - Close File                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 3EH                                           â”‚  â”‚
â”‚   â”‚   MOV BX, handle                                        â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 3FH - Read File                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 3FH                                           â”‚  â”‚
â”‚   â”‚   MOV BX, handle                                        â”‚  â”‚
â”‚   â”‚   MOV CX, count       ; Bytes to read                  â”‚  â”‚
â”‚   â”‚   LEA DX, BUFFER                                        â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AX = bytes actually read                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 40H - Write File                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 40H                                           â”‚  â”‚
â”‚   â”‚   MOV BX, handle      ; 1=stdout (screen)              â”‚  â”‚
â”‚   â”‚   MOV CX, count       ; Bytes to write                 â”‚  â”‚
â”‚   â”‚   LEA DX, BUFFER                                        â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; AX = bytes actually written                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 System Functions

```
DOS INT 21H - SYSTEM FUNCTIONS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 00H - Terminate Program (obsolete)                   â”‚
â”‚   FUNCTION 4CH - Terminate with Return Code (recommended)       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 4CH                                           â”‚  â”‚
â”‚   â”‚   MOV AL, return_code    ; 0 = success                  â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 25H - Set Interrupt Vector                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 25H                                           â”‚  â”‚
â”‚   â”‚   MOV AL, int_number                                    â”‚  â”‚
â”‚   â”‚   LEA DX, new_handler    ; DS:DX = new handler         â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 35H - Get Interrupt Vector                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 35H                                           â”‚  â”‚
â”‚   â”‚   MOV AL, int_number                                    â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; ES:BX = current handler address                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 2AH - Get Date                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 2AH                                           â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; CX = year, DH = month, DL = day                    â”‚  â”‚
â”‚   â”‚   ; AL = day of week (0=Sunday)                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 2CH - Get Time                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 2CH                                           â”‚  â”‚
â”‚   â”‚   INT 21H                                               â”‚  â”‚
â”‚   â”‚   ; CH = hour, CL = minute                             â”‚  â”‚
â”‚   â”‚   ; DH = second, DL = 1/100 second                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. BIOS Interrupts

### 3.1 Video BIOS (INT 10H)

```
BIOS INT 10H - VIDEO SERVICES:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 00H - Set Video Mode                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 00H                                           â”‚  â”‚
â”‚   â”‚   MOV AL, mode                                          â”‚  â”‚
â”‚   â”‚   INT 10H                                               â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   Common modes:                                         â”‚  â”‚
â”‚   â”‚   03H = 80Ã—25 text, 16 colors                          â”‚  â”‚
â”‚   â”‚   12H = 640Ã—480 graphics, 16 colors                    â”‚  â”‚
â”‚   â”‚   13H = 320Ã—200 graphics, 256 colors                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 02H - Set Cursor Position                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 02H                                           â”‚  â”‚
â”‚   â”‚   MOV BH, 0           ; Page number                    â”‚  â”‚
â”‚   â”‚   MOV DH, row         ; Row (0-24)                     â”‚  â”‚
â”‚   â”‚   MOV DL, col         ; Column (0-79)                  â”‚  â”‚
â”‚   â”‚   INT 10H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 03H - Get Cursor Position                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 03H                                           â”‚  â”‚
â”‚   â”‚   MOV BH, 0                                             â”‚  â”‚
â”‚   â”‚   INT 10H                                               â”‚  â”‚
â”‚   â”‚   ; DH = row, DL = column                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 06H - Scroll Window Up (Clear Screen)                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 06H                                           â”‚  â”‚
â”‚   â”‚   MOV AL, 0           ; 0 = clear entire window        â”‚  â”‚
â”‚   â”‚   MOV BH, 07H         ; Attribute for blank lines      â”‚  â”‚
â”‚   â”‚   MOV CH, 0           ; Upper row                      â”‚  â”‚
â”‚   â”‚   MOV CL, 0           ; Left column                    â”‚  â”‚
â”‚   â”‚   MOV DH, 24          ; Lower row                      â”‚  â”‚
â”‚   â”‚   MOV DL, 79          ; Right column                   â”‚  â”‚
â”‚   â”‚   INT 10H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 09H - Write Character with Attribute                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 09H                                           â”‚  â”‚
â”‚   â”‚   MOV AL, char                                          â”‚  â”‚
â”‚   â”‚   MOV BH, 0           ; Page                           â”‚  â”‚
â”‚   â”‚   MOV BL, attr        ; Attribute (color)              â”‚  â”‚
â”‚   â”‚   MOV CX, count       ; Repeat count                   â”‚  â”‚
â”‚   â”‚   INT 10H                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 0EH - Write Character (Teletype)                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 0EH                                           â”‚  â”‚
â”‚   â”‚   MOV AL, char                                          â”‚  â”‚
â”‚   â”‚   INT 10H             ; Advances cursor               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Keyboard BIOS (INT 16H)

```
BIOS INT 16H - KEYBOARD SERVICES:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   FUNCTION 00H - Read Key (Wait)                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 00H                                           â”‚  â”‚
â”‚   â”‚   INT 16H                                               â”‚  â”‚
â”‚   â”‚   ; AH = scan code, AL = ASCII code                    â”‚  â”‚
â”‚   â”‚   ; Waits for keypress                                 â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚   Common Scan Codes:                                    â”‚  â”‚
â”‚   â”‚   01H = Escape                                          â”‚  â”‚
â”‚   â”‚   0EH = Backspace                                       â”‚  â”‚
â”‚   â”‚   1CH = Enter                                           â”‚  â”‚
â”‚   â”‚   3BH-44H = F1-F10                                      â”‚  â”‚
â”‚   â”‚   48H = Up Arrow                                        â”‚  â”‚
â”‚   â”‚   4BH = Left Arrow                                      â”‚  â”‚
â”‚   â”‚   4DH = Right Arrow                                     â”‚  â”‚
â”‚   â”‚   50H = Down Arrow                                      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 01H - Check Keyboard Buffer                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 01H                                           â”‚  â”‚
â”‚   â”‚   INT 16H                                               â”‚  â”‚
â”‚   â”‚   ; ZF = 1: no key waiting                             â”‚  â”‚
â”‚   â”‚   ; ZF = 0: key waiting, AH=scan, AL=ASCII             â”‚  â”‚
â”‚   â”‚   ; Key remains in buffer                              â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚   FUNCTION 02H - Get Shift Flags                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MOV AH, 02H                                           â”‚  â”‚
â”‚   â”‚   INT 16H                                               â”‚  â”‚
â”‚   â”‚   ; AL = shift flag status                             â”‚  â”‚
â”‚   â”‚   ; Bit 0: Right Shift                                 â”‚  â”‚
â”‚   â”‚   ; Bit 1: Left Shift                                  â”‚  â”‚
â”‚   â”‚   ; Bit 2: Ctrl                                        â”‚  â”‚
â”‚   â”‚   ; Bit 3: Alt                                         â”‚  â”‚
â”‚   â”‚   ; Bit 4: Scroll Lock on                              â”‚  â”‚
â”‚   â”‚   ; Bit 5: Num Lock on                                 â”‚  â”‚
â”‚   â”‚   ; Bit 6: Caps Lock on                                â”‚  â”‚
â”‚   â”‚   ; Bit 7: Insert on                                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Writing Interrupt Service Routines

### 4.1 ISR Structure

```
INTERRUPT SERVICE ROUTINE STRUCTURE:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   ISR REQUIREMENTS:                                              â”‚
â”‚   â€¢ Save all registers that will be modified                   â”‚
â”‚   â€¢ Must end with IRET (not RET)                               â”‚
â”‚   â€¢ Keep it short and fast                                      â”‚
â”‚   â€¢ Don't call DOS from hardware ISRs                          â”‚
â”‚                                                                  â”‚
â”‚   BASIC ISR TEMPLATE:                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MY_ISR PROC FAR                                       â”‚  â”‚
â”‚   â”‚       ; Save registers                                  â”‚  â”‚
â”‚   â”‚       PUSH AX                                           â”‚  â”‚
â”‚   â”‚       PUSH BX                                           â”‚  â”‚
â”‚   â”‚       PUSH CX                                           â”‚  â”‚
â”‚   â”‚       PUSH DX                                           â”‚  â”‚
â”‚   â”‚       PUSH DS                                           â”‚  â”‚
â”‚   â”‚       PUSH ES                                           â”‚  â”‚
â”‚   â”‚       PUSH SI                                           â”‚  â”‚
â”‚   â”‚       PUSH DI                                           â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚       ; Set up DS if needed                             â”‚  â”‚
â”‚   â”‚       MOV AX, @DATA                                     â”‚  â”‚
â”‚   â”‚       MOV DS, AX                                        â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚       ; === ISR CODE HERE ===                           â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚       ; Restore registers                               â”‚  â”‚
â”‚   â”‚       POP DI                                            â”‚  â”‚
â”‚   â”‚       POP SI                                            â”‚  â”‚
â”‚   â”‚       POP ES                                            â”‚  â”‚
â”‚   â”‚       POP DS                                            â”‚  â”‚
â”‚   â”‚       POP DX                                            â”‚  â”‚
â”‚   â”‚       POP CX                                            â”‚  â”‚
â”‚   â”‚       POP BX                                            â”‚  â”‚
â”‚   â”‚       POP AX                                            â”‚  â”‚
â”‚   â”‚                                                          â”‚  â”‚
â”‚   â”‚       IRET            ; Return from interrupt           â”‚  â”‚
â”‚   â”‚   MY_ISR ENDP                                           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Installing Custom ISR

```asm
;------------------------------------------------
; EXAMPLE: Custom INT 60H Handler
;------------------------------------------------
.MODEL SMALL
.STACK 100H

.DATA
    OLD_VEC     DD  ?       ; Storage for old vector
    MSG         DB  'Custom interrupt called!$'

.CODE

;------------------------------------------------
; Custom interrupt handler
;------------------------------------------------
MY_INT60 PROC FAR
    PUSH AX
    PUSH DX
    PUSH DS
    
    ; Set up data segment
    MOV AX, @DATA
    MOV DS, AX
    
    ; Display message
    MOV AH, 09H
    LEA DX, MSG
    INT 21H
    
    POP DS
    POP DX
    POP AX
    IRET
MY_INT60 ENDP

;------------------------------------------------
; Main program
;------------------------------------------------
MAIN PROC
    MOV AX, @DATA
    MOV DS, AX
    
    ; Save old INT 60H vector
    MOV AH, 35H
    MOV AL, 60H
    INT 21H
    MOV WORD PTR OLD_VEC, BX      ; Offset
    MOV WORD PTR OLD_VEC+2, ES    ; Segment
    
    ; Install new handler
    PUSH DS
    MOV AX, SEG MY_INT60
    MOV DS, AX
    LEA DX, MY_INT60
    MOV AH, 25H
    MOV AL, 60H
    INT 21H
    POP DS
    
    ; Test the interrupt
    INT 60H
    
    ; Restore old handler
    PUSH DS
    LDS DX, OLD_VEC
    MOV AH, 25H
    MOV AL, 60H
    INT 21H
    POP DS
    
    ; Exit
    MOV AH, 4CH
    INT 21H
MAIN ENDP

END MAIN
```

### 4.3 Hardware ISR Example (Timer)

```asm
;------------------------------------------------
; EXAMPLE: Hook Timer Interrupt (INT 08H)
; Counts timer ticks
;------------------------------------------------
.MODEL SMALL
.STACK 100H

.DATA
    OLD_INT08   DD  ?
    TICK_COUNT  DW  0
    MSG         DB  'Timer ticks: $'

.CODE

;------------------------------------------------
; Timer interrupt hook
;------------------------------------------------
NEW_INT08 PROC FAR
    ; Increment counter
    INC CS:TICK_COUNTER
    
    ; Chain to old handler (important!)
    JMP CS:OLD_INT08
NEW_INT08 ENDP

TICK_COUNTER DW 0

;------------------------------------------------
MAIN PROC
    MOV AX, @DATA
    MOV DS, AX
    
    ; Save old INT 08H
    MOV AH, 35H
    MOV AL, 08H
    INT 21H
    MOV WORD PTR OLD_INT08, BX
    MOV WORD PTR OLD_INT08+2, ES
    
    ; Install new handler
    CLI                     ; Disable interrupts
    PUSH DS
    PUSH CS
    POP DS
    LEA DX, NEW_INT08
    MOV AH, 25H
    MOV AL, 08H
    INT 21H
    POP DS
    STI                     ; Enable interrupts
    
    ; Wait for some ticks (press key to continue)
    MOV AH, 01H
    INT 21H
    
    ; Restore old handler
    CLI
    PUSH DS
    LDS DX, OLD_INT08
    MOV AH, 25H
    MOV AL, 08H
    INT 21H
    POP DS
    STI
    
    ; Display count
    MOV AH, 09H
    LEA DX, MSG
    INT 21H
    
    MOV AX, CS:TICK_COUNTER
    CALL PRINT_NUM
    
    MOV AH, 4CH
    INT 21H
MAIN ENDP

;------------------------------------------------
PRINT_NUM PROC
    ; Print AX as decimal
    PUSH AX
    PUSH BX
    PUSH CX
    PUSH DX
    
    MOV BX, 10
    XOR CX, CX
    
DIV_LOOP:
    XOR DX, DX
    DIV BX
    PUSH DX
    INC CX
    OR AX, AX
    JNZ DIV_LOOP
    
PRINT_LOOP:
    POP DX
    ADD DL, '0'
    MOV AH, 02H
    INT 21H
    LOOP PRINT_LOOP
    
    POP DX
    POP CX
    POP BX
    POP AX
    RET
PRINT_NUM ENDP

END MAIN
```

---

## 5. Complete Program Examples

### 5.1 Menu-Driven Program

```asm
;------------------------------------------------
; MENU PROGRAM using various interrupts
;------------------------------------------------
.MODEL SMALL
.STACK 100H

.DATA
    MENU    DB  0DH, 0AH
            DB  '==== MAIN MENU ====', 0DH, 0AH
            DB  '1. Clear Screen', 0DH, 0AH
            DB  '2. Show Date', 0DH, 0AH
            DB  '3. Show Time', 0DH, 0AH
            DB  '4. Exit', 0DH, 0AH
            DB  'Choice: $'
    
    DATE_MSG DB  0DH, 0AH, 'Date: $'
    TIME_MSG DB  0DH, 0AH, 'Time: $'
    SLASH    DB  '/$'
    COLON    DB  ':$'

.CODE
MAIN PROC
    MOV AX, @DATA
    MOV DS, AX

MENU_LOOP:
    ; Display menu
    MOV AH, 09H
    LEA DX, MENU
    INT 21H
    
    ; Get choice
    MOV AH, 01H
    INT 21H
    
    CMP AL, '1'
    JE DO_CLEAR
    CMP AL, '2'
    JE DO_DATE
    CMP AL, '3'
    JE DO_TIME
    CMP AL, '4'
    JE DO_EXIT
    JMP MENU_LOOP

DO_CLEAR:
    ; Clear screen (INT 10H)
    MOV AH, 06H
    MOV AL, 0
    MOV BH, 07H
    MOV CX, 0
    MOV DX, 184FH
    INT 10H
    ; Home cursor
    MOV AH, 02H
    MOV BH, 0
    MOV DX, 0
    INT 10H
    JMP MENU_LOOP

DO_DATE:
    MOV AH, 09H
    LEA DX, DATE_MSG
    INT 21H
    
    ; Get date
    MOV AH, 2AH
    INT 21H
    ; DL=day, DH=month, CX=year
    
    PUSH CX
    MOV AL, DH
    CALL PRINT_2DIGIT
    MOV AH, 09H
    LEA DX, SLASH
    INT 21H
    MOV AL, DL
    CALL PRINT_2DIGIT
    MOV AH, 09H
    LEA DX, SLASH
    INT 21H
    POP AX
    CALL PRINT_NUM
    JMP MENU_LOOP

DO_TIME:
    MOV AH, 09H
    LEA DX, TIME_MSG
    INT 21H
    
    ; Get time
    MOV AH, 2CH
    INT 21H
    ; CH=hour, CL=minute, DH=second
    
    MOV AL, CH
    CALL PRINT_2DIGIT
    PUSH DX
    MOV AH, 09H
    LEA DX, COLON
    INT 21H
    POP DX
    MOV AL, CL
    CALL PRINT_2DIGIT
    PUSH DX
    MOV AH, 09H
    LEA DX, COLON
    INT 21H
    POP DX
    MOV AL, DH
    CALL PRINT_2DIGIT
    JMP MENU_LOOP

DO_EXIT:
    MOV AH, 4CH
    INT 21H
MAIN ENDP

;------------------------------------------------
PRINT_2DIGIT PROC
    ; Print AL as 2-digit number
    PUSH AX
    PUSH DX
    XOR AH, AH
    MOV DL, 10
    DIV DL
    ADD AL, '0'
    MOV DL, AL
    PUSH AX
    MOV AH, 02H
    INT 21H
    POP AX
    ADD AH, '0'
    MOV DL, AH
    MOV AH, 02H
    INT 21H
    POP DX
    POP AX
    RET
PRINT_2DIGIT ENDP

;------------------------------------------------
PRINT_NUM PROC
    ; Print AX as decimal
    PUSH AX
    PUSH BX
    PUSH CX
    PUSH DX
    MOV BX, 10
    XOR CX, CX
PN_DIV:
    XOR DX, DX
    DIV BX
    PUSH DX
    INC CX
    OR AX, AX
    JNZ PN_DIV
PN_PRINT:
    POP DX
    ADD DL, '0'
    MOV AH, 02H
    INT 21H
    LOOP PN_PRINT
    POP DX
    POP CX
    POP BX
    POP AX
    RET
PRINT_NUM ENDP

END MAIN
```

---

## ğŸ“‹ Summary Table

| Interrupt | Function | Description |
|-----------|----------|-------------|
| INT 21H/01H | GETCHAR | Read char with echo |
| INT 21H/02H | PUTCHAR | Display character |
| INT 21H/09H | PUTS | Display string ($) |
| INT 21H/0AH | GETS | Buffered string input |
| INT 21H/4CH | EXIT | Terminate program |
| INT 21H/25H | SET_VEC | Set interrupt vector |
| INT 21H/35H | GET_VEC | Get interrupt vector |
| INT 10H/00H | SETMODE | Set video mode |
| INT 10H/02H | SETCUR | Set cursor position |
| INT 10H/06H | SCROLL | Scroll/clear window |
| INT 16H/00H | READKEY | Read keyboard (wait) |
| INT 16H/01H | KBHIT | Check keyboard buffer |

---

## â“ Quick Revision Questions

1. **What is the Interrupt Vector Table?**
   <details>
   <summary>Show Answer</summary>
   IVT is a table in the first 1KB of memory (0000:0000 to 0000:03FF) containing 256 4-byte entries. Each entry holds the CS:IP address of an interrupt handler. Vector address = interrupt number Ã— 4. When INT n is executed, CPU fetches CS:IP from location nÃ—4.
   </details>

2. **What's the difference between INT 21H functions 01H and 08H?**
   <details>
   <summary>Show Answer</summary>
   Both read a character from keyboard. Function 01H echoes the character to screen; function 08H does not echo (silent input). Both check for Ctrl+C. Function 07H is similar to 08H but doesn't check Ctrl+C.
   </details>

3. **Why must strings for INT 21H/09H end with '$'?**
   <details>
   <summary>Show Answer</summary>
   DOS function 09H displays characters until it encounters '$' (24H). This is the string terminator for this function. Without it, DOS continues printing memory contents until it randomly finds a '$'. Note: '$' itself cannot be printed using this function.
   </details>

4. **What happens when an interrupt occurs?**
   <details>
   <summary>Show Answer</summary>
   1) Current instruction completes, 2) FLAGS pushed to stack, 3) IF and TF cleared (disable interrupts), 4) CS pushed, 5) IP pushed, 6) New CS:IP loaded from IVT, 7) ISR executes, 8) IRET restores IP, CS, FLAGS and returns.
   </details>

5. **Why use CLI and STI when installing ISRs?**
   <details>
   <summary>Show Answer</summary>
   CLI disables interrupts, STI enables them. When modifying the interrupt vector, we disable interrupts to prevent the interrupt from occurring while the vector is partially modified (race condition). After modification is complete, we re-enable interrupts.
   </details>

6. **Why must hardware ISRs chain to the original handler?**
   <details>
   <summary>Show Answer</summary>
   Original handler performs essential tasks (like timer updating system clock, keyboard filling buffer). If not chained, these functions break. Use JMP to old handler (not CALL) so the original handler's IRET returns properly. Only skip chaining if completely replacing functionality.
   </details>

---

## ğŸ§­ Navigation

| Previous | Up | Next |
|----------|-----|------|
| [5.3 Modular Programming](03-modular-programming.md) | [Unit 5 Index](README.md) | [5.5 String Operations](05-string-operations.md) |

---

*[â† Previous: Modular Programming](03-modular-programming.md) | [Next: String Operations â†’](05-string-operations.md)*
