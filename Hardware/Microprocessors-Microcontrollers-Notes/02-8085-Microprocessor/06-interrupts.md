# Chapter 2.6: Interrupts

## ğŸ“š Chapter Overview

Interrupts allow external devices to request processor attention, enabling efficient I/O handling without continuous polling. The 8085 has a sophisticated interrupt system with five hardware interrupts and priority management.

---

## ğŸ¯ Learning Objectives

After completing this chapter, you will be able to:
- Understand the interrupt concept and types
- Describe all 8085 hardware interrupts
- Explain interrupt priority and masking
- Use RIM and SIM instructions for interrupt control
- Write interrupt service routines

---

## 1. Introduction to Interrupts

### 1.1 What is an Interrupt?

```
INTERRUPT CONCEPT:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   WITHOUT INTERRUPTS (Polling):                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Main Program                                               â”‚ â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚   â”‚ â”‚ Task 1  â”‚â†’â”‚Check I/Oâ”‚â†’â”‚ Task 2  â”‚â†’â”‚Check I/Oâ”‚â†’ ...   â”‚ â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚   â”‚              â†‘ Wastes CPU time checking                    â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚   WITH INTERRUPTS:                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Main Program                                               â”‚ â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚   â”‚ â”‚ Task 1  â”‚â†’â”‚ Task 2  â”‚â†’â”‚ Task 3  â”‚â†’â”‚ Task 4  â”‚â†’ ...   â”‚ â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚   â”‚      â”‚                                                     â”‚ â”‚
â”‚   â”‚      â”‚ â† I/O Device requests attention (Interrupt!)        â”‚ â”‚
â”‚   â”‚      â–¼                                                     â”‚ â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚ â”‚
â”‚   â”‚ â”‚ Service Routine â”‚  CPU handles I/O only when needed     â”‚ â”‚
â”‚   â”‚ â”‚    (ISR)        â”‚                                        â”‚ â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚ â”‚
â”‚   â”‚          â”‚                                                  â”‚ â”‚
â”‚   â”‚          â–¼ Return to main program                          â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Interrupt Sequence

```
INTERRUPT PROCESSING STEPS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  1. INTERRUPT REQUEST                                           â”‚
â”‚     â””â”€â”€ External device activates interrupt pin                 â”‚
â”‚                                                                  â”‚
â”‚  2. INTERRUPT RECOGNITION                                       â”‚
â”‚     â””â”€â”€ CPU checks for interrupt at end of each instruction    â”‚
â”‚     â””â”€â”€ If interrupts enabled and not masked â†’ proceed         â”‚
â”‚                                                                  â”‚
â”‚  3. SAVE CONTEXT                                                â”‚
â”‚     â””â”€â”€ Push Program Counter (PC) to stack                     â”‚
â”‚     â””â”€â”€ For TRAP/RST: Hardware saves PC automatically          â”‚
â”‚     â””â”€â”€ For INTR: External device provides vector              â”‚
â”‚                                                                  â”‚
â”‚  4. DISABLE INTERRUPTS                                          â”‚
â”‚     â””â”€â”€ CPU clears interrupt enable flip-flop (IE = 0)         â”‚
â”‚     â””â”€â”€ Prevents nested interrupts (unless explicitly enabled) â”‚
â”‚                                                                  â”‚
â”‚  5. JUMP TO ISR                                                 â”‚
â”‚     â””â”€â”€ PC loaded with interrupt vector address                â”‚
â”‚     â””â”€â”€ Execution continues at ISR                             â”‚
â”‚                                                                  â”‚
â”‚  6. EXECUTE ISR                                                 â”‚
â”‚     â””â”€â”€ Service routine handles the interrupt                  â”‚
â”‚     â””â”€â”€ Must save and restore registers if used                â”‚
â”‚                                                                  â”‚
â”‚  7. RETURN FROM INTERRUPT                                       â”‚
â”‚     â””â”€â”€ EI instruction to re-enable interrupts                 â”‚
â”‚     â””â”€â”€ RET instruction pops PC from stack                     â”‚
â”‚     â””â”€â”€ Resume main program                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. 8085 Hardware Interrupts

### 2.1 Interrupt Overview

```
8085 INTERRUPT PINS:

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         8085            â”‚
                    â”‚                         â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ TRAP    (Pin 6)        â”‚
     (Edge & Level) â”‚   â†“                     â”‚
                    â”‚   Non-maskable          â”‚
                    â”‚   Highest Priority      â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ RST 7.5 (Pin 7)        â”‚
     (Edge)         â”‚   â†“                     â”‚
                    â”‚   Maskable              â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ RST 6.5 (Pin 8)        â”‚
     (Level)        â”‚   â†“                     â”‚
                    â”‚   Maskable              â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ RST 5.5 (Pin 9)        â”‚
     (Level)        â”‚   â†“                     â”‚
                    â”‚   Maskable              â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ INTR    (Pin 10)       â”‚
     (Level)        â”‚   â†“                     â”‚
                    â”‚   Lowest Priority       â”‚
                    â”‚                         â”‚
     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ INTA    (Pin 11)       â”‚
     (Acknowledge)  â”‚   â†“                     â”‚
                    â”‚   Output signal         â”‚
                    â”‚                         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Interrupt Characteristics Table

| Interrupt | Type | Trigger | Maskable | Vector Address | Priority |
|-----------|------|---------|----------|----------------|----------|
| TRAP | Vectored | Edge & Level | No | 0024H | 1 (Highest) |
| RST 7.5 | Vectored | Edge (Rising) | Yes | 003CH | 2 |
| RST 6.5 | Vectored | Level (High) | Yes | 0034H | 3 |
| RST 5.5 | Vectored | Level (High) | Yes | 002CH | 4 |
| INTR | Non-vectored | Level (High) | Yes | External* | 5 (Lowest) |

*INTR vector provided by external device via RST instruction

### 2.3 Vector Address Calculation

```
INTERRUPT VECTOR ADDRESSES:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                    â”‚
â”‚   Interrupt    Vector = n Ã— 8       Address                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚   TRAP         4.5 Ã— 8 = 36 = 24H   0024H                         â”‚
â”‚   RST 7.5      7.5 Ã— 8 = 60 = 3CH   003CH                         â”‚
â”‚   RST 6.5      6.5 Ã— 8 = 52 = 34H   0034H                         â”‚
â”‚   RST 5.5      5.5 Ã— 8 = 44 = 2CH   002CH                         â”‚
â”‚                                                                    â”‚
â”‚   MEMORY MAP:                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  0000H   â”‚  Reset / RST 0                 â”‚                   â”‚
â”‚   â”‚  0008H   â”‚  RST 1                         â”‚                   â”‚
â”‚   â”‚  0010H   â”‚  RST 2                         â”‚                   â”‚
â”‚   â”‚  0018H   â”‚  RST 3                         â”‚                   â”‚
â”‚   â”‚  0020H   â”‚  RST 4                         â”‚                   â”‚
â”‚   â”‚  0024H   â”‚  TRAP                          â”‚ â—„â”€ TRAP ISR here  â”‚
â”‚   â”‚  0028H   â”‚  RST 5                         â”‚                   â”‚
â”‚   â”‚  002CH   â”‚  RST 5.5                       â”‚ â—„â”€ RST 5.5 ISR    â”‚
â”‚   â”‚  0030H   â”‚  RST 6                         â”‚                   â”‚
â”‚   â”‚  0034H   â”‚  RST 6.5                       â”‚ â—„â”€ RST 6.5 ISR    â”‚
â”‚   â”‚  0038H   â”‚  RST 7                         â”‚                   â”‚
â”‚   â”‚  003CH   â”‚  RST 7.5                       â”‚ â—„â”€ RST 7.5 ISR    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                    â”‚
â”‚   Only 8 bytes available between vectors!                         â”‚
â”‚   Usually contains: JMP to actual ISR                             â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Individual Interrupt Details

### 3.1 TRAP (Non-Maskable Interrupt)

```
TRAP INTERRUPT:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TRAP CHARACTERISTICS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â€¢ NON-MASKABLE: Cannot be disabled by software                 â”‚
â”‚  â€¢ Highest priority among all interrupts                        â”‚
â”‚  â€¢ Edge AND Level triggered (rising edge, then high level)      â”‚
â”‚  â€¢ Vector address: 0024H                                        â”‚
â”‚  â€¢ Used for critical events: Power failure, memory parity       â”‚
â”‚                                                                  â”‚
â”‚  TRIGGER MECHANISM:                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                  â”‚
â”‚  TRAP  â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
â”‚             â”‚     â”‚                                              â”‚
â”‚             â””â”€â”€â”€â”€â”€â”˜                                              â”‚
â”‚                   â–²                                              â”‚
â”‚                   â”‚ Must have rising edge                        â”‚
â”‚                   â”‚ AND remain HIGH for recognition             â”‚
â”‚                                                                  â”‚
â”‚  This edge+level requirement prevents noise-triggered traps     â”‚
â”‚                                                                  â”‚
â”‚  TYPICAL USE:                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  Power fail detection:                                           â”‚
â”‚  â€¢ Capacitor maintains VCC briefly after power loss             â”‚
â”‚  â€¢ TRAP ISR saves critical data to non-volatile memory          â”‚
â”‚  â€¢ System enters halt state gracefully                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 RST 7.5 (Edge-Triggered, Maskable)

```
RST 7.5 INTERRUPT:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      RST 7.5 CHARACTERISTICS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â€¢ EDGE-TRIGGERED: Latches on rising edge                       â”‚
â”‚  â€¢ Has internal flip-flop to remember request                   â”‚
â”‚  â€¢ Maskable via SIM instruction                                 â”‚
â”‚  â€¢ Vector address: 003CH                                        â”‚
â”‚  â€¢ Higher priority than RST 6.5 and RST 5.5                     â”‚
â”‚                                                                  â”‚
â”‚  TRIGGER AND LATCH MECHANISM:                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚   RST 7.5 â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  D    Q   â”œâ”€â”€â”€â”€â–º To Interrupt Logic        â”‚
â”‚   (Pin 7)    â”Œâ”€â”€â”€â–ºâ”‚ CLK  CLR  â”‚                                 â”‚
â”‚              â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚              â”‚          â”‚                                        â”‚
â”‚    Rising    â”‚          â”‚ D4 of SIM (Reset RST 7.5)            â”‚
â”‚    Edge      â”‚          â”‚                                        â”‚
â”‚              â”‚          â–¼                                        â”‚
â”‚              â”‚    Can be reset by:                               â”‚
â”‚              â”‚    1. SIM with D4=1                               â”‚
â”‚              â”‚    2. Servicing the interrupt                     â”‚
â”‚              â”‚                                                   â”‚
â”‚                                                                  â”‚
â”‚  IMPORTANT:                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚  Unlike level-triggered interrupts, once RST 7.5 latches,       â”‚
â”‚  it remains pending even if the signal goes LOW.                â”‚
â”‚  Must use SIM to clear if needed.                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 RST 6.5 and RST 5.5 (Level-Triggered, Maskable)

```
RST 6.5 AND RST 5.5 INTERRUPTS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  LEVEL-TRIGGERED INTERRUPTS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  RST 6.5:                                                       â”‚
â”‚  â€¢ Level-triggered (active HIGH)                                â”‚
â”‚  â€¢ Maskable via SIM                                             â”‚
â”‚  â€¢ Vector: 0034H                                                â”‚
â”‚  â€¢ Priority: Below RST 7.5                                      â”‚
â”‚                                                                  â”‚
â”‚  RST 5.5:                                                       â”‚
â”‚  â€¢ Level-triggered (active HIGH)                                â”‚
â”‚  â€¢ Maskable via SIM                                             â”‚
â”‚  â€¢ Vector: 002CH                                                â”‚
â”‚  â€¢ Priority: Below RST 6.5                                      â”‚
â”‚                                                                  â”‚
â”‚  LEVEL-TRIGGERED BEHAVIOR:                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                  â”‚
â”‚  RST 6.5/5.5  â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚                     â”‚          â”‚                                 â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                          â”‚                                       â”‚
â”‚                          â–¼                                       â”‚
â”‚           Signal must be HIGH when checked                       â”‚
â”‚           No internal latch (unlike RST 7.5)                    â”‚
â”‚                                                                  â”‚
â”‚  CAUTION:                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚  If interrupt pin remains HIGH during ISR, it will              â”‚
â”‚  be recognized again after EI! The external device              â”‚
â”‚  must remove the signal, or ISR must mask it.                   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 INTR (General Purpose Interrupt)

```
INTR INTERRUPT:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INTR CHARACTERISTICS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â€¢ NON-VECTORED: External device provides vector                â”‚
â”‚  â€¢ Level-triggered (active HIGH)                                â”‚
â”‚  â€¢ Lowest priority                                              â”‚
â”‚  â€¢ Maskable via EI/DI instructions                              â”‚
â”‚                                                                  â”‚
â”‚  INTR-INTA HANDSHAKE:                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                  â”‚
â”‚  External Device              8085                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
â”‚                                                                  â”‚
â”‚      INTR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (Recognized if IE=1)             â”‚
â”‚                                                                  â”‚
â”‚           â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ INTA (Acknowledge)               â”‚
â”‚                                                                  â”‚
â”‚      RST n â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (Device puts RST on data bus)    â”‚
â”‚      (on data bus)                                               â”‚
â”‚                                                                  â”‚
â”‚                                PC â† n Ã— 8 (Vector)              â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚  EXTERNAL CIRCUIT:                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                                  â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚      â”‚   Device    â”‚                                            â”‚
â”‚      â”‚  Controller â”‚â”€â”€â”€INTRâ”€â”€â”€â–ºâ”‚                                â”‚
â”‚      â”‚   (8259)    â”‚â—„â”€â”€INTAâ”€â”€â”€â”€â”‚  8085                          â”‚
â”‚      â”‚             â”‚â”€â”€â”€D0-D7â”€â”€â–ºâ”‚                                â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                  â”‚
â”‚  RST OPCODES ON DATA BUS:                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚  RST 0 = C7H, RST 1 = CFH, RST 2 = D7H, RST 3 = DFH            â”‚
â”‚  RST 4 = E7H, RST 5 = EFH, RST 6 = F7H, RST 7 = FFH            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Interrupt Enable and Masking

### 4.1 Interrupt Enable/Disable (EI/DI)

```
EI AND DI INSTRUCTIONS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  EI (Enable Interrupts):  Opcode FB                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  â€¢ Sets Interrupt Enable flip-flop (IE = 1)                     â”‚
â”‚  â€¢ Enables INTR, RST 5.5, RST 6.5, RST 7.5                     â”‚
â”‚  â€¢ Does NOT affect TRAP                                         â”‚
â”‚  â€¢ Effect is delayed by one instruction                         â”‚
â”‚                                                                  â”‚
â”‚  DI (Disable Interrupts):  Opcode F3                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  â€¢ Clears Interrupt Enable flip-flop (IE = 0)                   â”‚
â”‚  â€¢ Disables INTR, RST 5.5, RST 6.5, RST 7.5                    â”‚
â”‚  â€¢ TRAP cannot be disabled!                                     â”‚
â”‚                                                                  â”‚
â”‚  INTERRUPT ENABLE FLIP-FLOP:                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚                                                                  â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  EI â”€â”¤ S              Q   â”œâ”€â–º Interrupt Enable (IE)             â”‚
â”‚      â”‚                    â”‚                                      â”‚
â”‚  DI â”€â”¤ R              QÌ„   â”‚                                      â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚            â–²                                                     â”‚
â”‚            â”‚ Also cleared by:                                    â”‚
â”‚            â”‚ â€¢ RESET                                             â”‚
â”‚            â”‚ â€¢ Interrupt acknowledgment                         â”‚
â”‚                                                                  â”‚
â”‚  DELAYED EI EFFECT:                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚  EI takes effect AFTER the instruction following it.           â”‚
â”‚  This allows: EI / RET sequence in ISR                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 SIM Instruction (Set Interrupt Mask)

```
SIM (SET INTERRUPT MASK) INSTRUCTION:

Opcode: 30H
Function: Sets interrupt masks and serial output data

ACCUMULATOR FORMAT FOR SIM:
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚  D7 â”‚  D6 â”‚  D5 â”‚  D4 â”‚  D3 â”‚  D2 â”‚  D1 â”‚  D0 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ SOD â”‚ SOE â”‚  X  â”‚R7.5 â”‚ MSE â”‚M7.5 â”‚M6.5 â”‚M5.5 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
  â”‚     â”‚         â”‚     â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚         â”‚     â”‚     â”‚     â”‚     â””â”€ Mask RST 5.5 (1=masked)
  â”‚     â”‚         â”‚     â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€ Mask RST 6.5 (1=masked)
  â”‚     â”‚         â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Mask RST 7.5 (1=masked)
  â”‚     â”‚         â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Mask Set Enable
  â”‚     â”‚         â”‚                          (1=use D0-D2 masks)
  â”‚     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Reset RST 7.5 latch
  â”‚     â”‚                                    (1=reset)
  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SOD Enable (1=enable SOD)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Serial Output Data

EXAMPLES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Mask RST 7.5, unmask RST 6.5 and 5.5:
   MVI A, 0CH       ; 0000 1100: MSE=1, M7.5=1, M6.5=0, M5.5=0
   SIM

2. Unmask all RST interrupts:
   MVI A, 08H       ; 0000 1000: MSE=1, M7.5=0, M6.5=0, M5.5=0
   SIM

3. Reset RST 7.5 latch (clear pending interrupt):
   MVI A, 18H       ; 0001 1000: R7.5=1, MSE=1, masks=0
   SIM

4. Send serial output HIGH on SOD:
   MVI A, C0H       ; 1100 0000: SOD=1, SOE=1
   SIM

5. Mask RST 5.5 only, reset RST 7.5 latch:
   MVI A, 19H       ; 0001 1001: R7.5=1, MSE=1, M5.5=1
   SIM
```

### 4.3 RIM Instruction (Read Interrupt Mask)

```
RIM (READ INTERRUPT MASK) INSTRUCTION:

Opcode: 20H
Function: Reads interrupt status and serial input data

ACCUMULATOR AFTER RIM:
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚  D7 â”‚  D6 â”‚  D5 â”‚  D4 â”‚  D3 â”‚  D2 â”‚  D1 â”‚  D0 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ SID â”‚I7.5 â”‚I6.5 â”‚I5.5 â”‚  IE â”‚M7.5 â”‚M6.5 â”‚M5.5 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚
  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â””â”€ RST 5.5 mask status
  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€ RST 6.5 mask status
  â”‚     â”‚     â”‚     â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RST 7.5 mask status
  â”‚     â”‚     â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Interrupt Enable status
  â”‚     â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RST 5.5 pending
  â”‚     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RST 6.5 pending
  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RST 7.5 pending
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Serial Input Data

D7-D4: STATUS (Read-only)
D3-D0: MASK and IE status

EXAMPLES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Check if RST 7.5 interrupt is pending:
   RIM
   ANI 40H         ; Mask out all except I7.5 (D6)
   JNZ RST75_PENDING

2. Check if interrupts are enabled:
   RIM
   ANI 08H         ; Check IE bit (D3)
   JZ INT_DISABLED

3. Read serial input data:
   RIM
   ANI 80H         ; Check SID (D7)
   RRC             ; Move to bit 0
   ; Now A contains SID bit

4. Check all pending interrupts:
   RIM
   ANI 70H         ; Mask I7.5, I6.5, I5.5 (D6-D4)
   ; A now shows which interrupts are pending
```

---

## 5. Interrupt Priority

### 5.1 Priority Scheme

```
8085 INTERRUPT PRIORITY:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   PRIORITY RANKING:                                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚                      TRAP                          â”‚ â—„ Highestâ”‚
â”‚   â”‚                   (Priority 1)                     â”‚        â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                     RST 7.5                        â”‚        â”‚
â”‚   â”‚                   (Priority 2)                     â”‚        â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                     RST 6.5                        â”‚        â”‚
â”‚   â”‚                   (Priority 3)                     â”‚        â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                     RST 5.5                        â”‚        â”‚
â”‚   â”‚                   (Priority 4)                     â”‚        â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚   â”‚                      INTR                          â”‚ â—„ Lowestâ”‚
â”‚   â”‚                   (Priority 5)                     â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚   PRIORITY LOGIC:                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚                                                                  â”‚
â”‚   If multiple interrupts occur simultaneously:                  â”‚
â”‚   â€¢ Highest priority is serviced first                          â”‚
â”‚   â€¢ Lower priority must wait                                    â”‚
â”‚                                                                  â”‚
â”‚   During ISR:                                                    â”‚
â”‚   â€¢ All interrupts disabled (IE = 0)                            â”‚
â”‚   â€¢ TRAP can still occur (non-maskable)                         â”‚
â”‚   â€¢ Must use EI to enable nested interrupts                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Priority Control Using SIM

```
CONTROLLING INTERRUPT PRIORITY WITH MASKS:

SCENARIO: Need RST 5.5 higher priority than RST 7.5

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   DEFAULT:     7.5 > 6.5 > 5.5                                  â”‚
â”‚   MODIFIED:    5.5 > 6.5 > 7.5 (Using masks)                    â”‚
â”‚                                                                  â”‚
â”‚   TECHNIQUE:                                                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚   In RST 5.5 ISR, keep RST 7.5 and 6.5 masked                  â”‚
â”‚   In RST 6.5 ISR, keep RST 7.5 masked                          â”‚
â”‚   In RST 7.5 ISR, no masking needed                            â”‚
â”‚                                                                  â”‚
â”‚   EXAMPLE - RST 5.5 ISR (highest priority):                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚                                                                  â”‚
â”‚   RST55_ISR:                                                     â”‚
â”‚       PUSH PSW                                                   â”‚
â”‚       PUSH B                                                     â”‚
â”‚       ; ... save other registers ...                             â”‚
â”‚                                                                  â”‚
â”‚       MVI A, 0EH      ; Mask 7.5 and 6.5, enable 5.5            â”‚
â”‚       SIM             ; 0000 1110                               â”‚
â”‚       EI              ; Allow higher priority (5.5 only)        â”‚
â”‚                                                                  â”‚
â”‚       ; ... service the interrupt ...                            â”‚
â”‚                                                                  â”‚
â”‚       ; Restore original mask before returning                  â”‚
â”‚       MVI A, 08H      ; Unmask all                               â”‚
â”‚       SIM                                                        â”‚
â”‚                                                                  â”‚
â”‚       ; ... restore registers ...                                â”‚
â”‚       POP B                                                      â”‚
â”‚       POP PSW                                                    â”‚
â”‚       EI                                                         â”‚
â”‚       RET                                                        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Interrupt Service Routine (ISR) Structure

### 6.1 General ISR Template

```
INTERRUPT SERVICE ROUTINE TEMPLATE:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   ; ISR Entry Point (at vector address)                         â”‚
â”‚   ; Example for RST 7.5 at 003CH                                â”‚
â”‚                                                                  â”‚
â”‚   ORG 003CH                                                      â”‚
â”‚       JMP RST75_HANDLER    ; Jump to actual handler             â”‚
â”‚                                                                  â”‚
â”‚   ; Actual ISR (placed elsewhere in memory)                     â”‚
â”‚   RST75_HANDLER:                                                 â”‚
â”‚       ; 1. SAVE CONTEXT (registers used in ISR)                 â”‚
â”‚       PUSH PSW             ; Save A and Flags                    â”‚
â”‚       PUSH B               ; Save BC                             â”‚
â”‚       PUSH D               ; Save DE                             â”‚
â”‚       PUSH H               ; Save HL                             â”‚
â”‚                                                                  â”‚
â”‚       ; 2. SERVICE THE INTERRUPT                                 â”‚
â”‚       ; ... interrupt handling code ...                          â”‚
â”‚       ; Read data, clear device, update counters, etc.          â”‚
â”‚                                                                  â”‚
â”‚       ; 3. RESTORE CONTEXT                                       â”‚
â”‚       POP H                ; Restore HL                          â”‚
â”‚       POP D                ; Restore DE                          â”‚
â”‚       POP B                ; Restore BC                          â”‚
â”‚       POP PSW              ; Restore A and Flags                 â”‚
â”‚                                                                  â”‚
â”‚       ; 4. RE-ENABLE INTERRUPTS AND RETURN                      â”‚
â”‚       EI                   ; Enable interrupts                   â”‚
â”‚       RET                  ; Return to main program              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Complete Example: Timer Interrupt

```
EXAMPLE: TIMER USING RST 6.5

; Memory map
; 0000H-0003H: Reset vector
; 0034H-0036H: RST 6.5 vector
; 0100H: Main program
; 0200H: RST 6.5 handler

ORG 0000H
    JMP MAIN            ; Reset vector

ORG 0034H
    JMP TIMER_ISR       ; RST 6.5 vector

ORG 0100H
MAIN:
    LXI SP, FFFF        ; Initialize stack
    
    ; Enable RST 6.5, mask others
    MVI A, 0AH          ; 0000 1010: MSE=1, M6.5=0, M7.5=1, M5.5=0
    SIM
    
    ; Initialize timer counter
    MVI A, 00H
    STA TIMER_COUNT     ; Clear counter
    
    EI                  ; Enable interrupts
    
LOOP:
    ; Main program loop
    ; ... do other work ...
    JMP LOOP

; Timer ISR at 0200H
ORG 0200H
TIMER_ISR:
    PUSH PSW
    PUSH H
    
    ; Increment timer counter
    LDA TIMER_COUNT
    INR A
    STA TIMER_COUNT
    
    ; Check if 1 second (assuming 100 interrupts/sec)
    CPI 64H             ; 100 decimal
    JNZ NOT_SECOND
    
    ; One second elapsed
    MVI A, 00H
    STA TIMER_COUNT     ; Reset counter
    
    ; Toggle LED or perform 1-second action
    LDA LED_PORT
    CMA
    OUT LED_PORT
    
NOT_SECOND:
    POP H
    POP PSW
    EI
    RET

; Data
TIMER_COUNT: DB 0
LED_PORT:    EQU 01H
```

---

## 7. Interrupt Response Time

```
INTERRUPT RESPONSE (LATENCY):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚   MINIMUM LATENCY (Best Case):                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚   â€¢ 1 instruction cycle (end of current instruction)           â”‚
â”‚   â€¢ Typically 4-7 T-states                                      â”‚
â”‚   â€¢ Plus interrupt acknowledge cycles                           â”‚
â”‚                                                                  â”‚
â”‚   MAXIMUM LATENCY (Worst Case):                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚   â€¢ End of longest instruction (CALL/XTHL = 18 T-states)       â”‚
â”‚   â€¢ Plus interrupt acknowledge cycles                           â”‚
â”‚   â€¢ Plus any higher-priority interrupts                         â”‚
â”‚                                                                  â”‚
â”‚   INTERRUPT ACKNOWLEDGE TIME:                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚   â€¢ Vectored (TRAP, RST n.5): 6 T-states                        â”‚
â”‚   â€¢ Non-vectored (INTR): 6 T-states + RST execution             â”‚
â”‚                                                                  â”‚
â”‚   CALCULATION EXAMPLE:                                           â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚   At 3.072 MHz (T = 325 ns):                                    â”‚
â”‚                                                                  â”‚
â”‚   Min latency = 4T + 6T = 10T = 3.25 Î¼s                         â”‚
â”‚   Max latency = 18T + 6T = 24T = 7.8 Î¼s                         â”‚
â”‚                                                                  â”‚
â”‚   Plus time for:                                                 â”‚
â”‚   â€¢ JMP in vector (10T)                                          â”‚
â”‚   â€¢ PUSH instructions in ISR                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Summary Table

| Feature | TRAP | RST 7.5 | RST 6.5 | RST 5.5 | INTR |
|---------|------|---------|---------|---------|------|
| Vector Address | 0024H | 003CH | 0034H | 002CH | External |
| Trigger | Edge+Level | Edge | Level | Level | Level |
| Maskable | No | Yes (SIM) | Yes (SIM) | Yes (SIM) | Yes (DI) |
| Priority | 1 (Highest) | 2 | 3 | 4 | 5 (Lowest) |
| Internal Latch | No | Yes | No | No | No |
| Acknowledge | None | None | None | None | INTA |

---

## â“ Quick Revision Questions

1. **Which 8085 interrupt cannot be disabled? Why is it designed this way?**
   <details>
   <summary>Show Answer</summary>
   TRAP cannot be disabled. It's designed for critical events like power failure or memory parity errors where the system must respond regardless of software state. It's non-maskable to ensure system safety.
   </details>

2. **What is the difference between RST 7.5 and RST 6.5 triggering?**
   <details>
   <summary>Show Answer</summary>
   RST 7.5 is edge-triggered with internal latch - once triggered by rising edge, it remains pending even if signal goes low. RST 6.5 is level-triggered - signal must be HIGH when checked. RST 7.5 latch can be reset using SIM with D4=1.
   </details>

3. **Write the SIM instruction to mask RST 6.5 only.**
   <details>
   <summary>Show Answer</summary>
   MVI A, 0AH ; Binary: 0000 1010 (MSE=1, M7.5=0, M6.5=1, M5.5=0)
   SIM
   </details>

4. **What does RIM instruction return in the accumulator?**
   <details>
   <summary>Show Answer</summary>
   D7=SID (serial input), D6=I7.5 pending, D5=I6.5 pending, D4=I5.5 pending, D3=IE (interrupt enable status), D2=M7.5 mask, D1=M6.5 mask, D0=M5.5 mask.
   </details>

5. **Why must EI be placed before RET in an ISR?**
   <details>
   <summary>Show Answer</summary>
   EI effect is delayed by one instruction. Placing EI before RET ensures interrupts are enabled after the ISR completes. If placed after RET, it would never execute. This also allows atomic ISR exit.
   </details>

6. **How does INTR differ from vectored interrupts?**
   <details>
   <summary>Show Answer</summary>
   INTR is non-vectored - the vector address comes from external device (via RST instruction on data bus during INTA). Vectored interrupts (TRAP, RST n.5) have fixed addresses built into CPU. INTR requires external hardware like 8259 PIC.
   </details>

---

## ğŸ§­ Navigation

| Previous | Up | Next |
|----------|-----|------|
| [2.5 Timing Diagrams](05-timing-diagrams.md) | [Unit 2 Index](README.md) | [Unit 3: 8085 Programming](../03-8085-Programming/README.md) |

---

*[â† Previous: Timing Diagrams](05-timing-diagrams.md) | [Next: Unit 3 - 8085 Programming â†’](../03-8085-Programming/README.md)*
