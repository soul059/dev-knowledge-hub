# Chapter 8.1: Distributed Databases

[â† Back to Table of Contents](../README.md)

---

## ğŸ“š Chapter Overview

**Distributed databases** store data across multiple computers connected by a network. They enable scalability, availability, and geographic distribution while introducing new challenges in consistency and coordination.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CHAPTER LEARNING GOALS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Understand distributed database architecture                 â”‚
â”‚  â€¢ Learn data fragmentation and replication                     â”‚
â”‚  â€¢ Understand distributed query processing                      â”‚
â”‚  â€¢ Learn distributed transaction management                     â”‚
â”‚  â€¢ Understand the CAP theorem and consistency models            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Introduction to Distributed Databases

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHY DISTRIBUTED DATABASES?                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Traditional (Centralized):
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
    â”‚          Client â”€â”€â”€â”€â”€â”€â†’â”‚   Server    â”‚â†â”€â”€â”€â”€â”€â”€ Client            â”‚
    â”‚          Client â”€â”€â”€â”€â”€â”€â†’â”‚  (Single)   â”‚â†â”€â”€â”€â”€â”€â”€ Client            â”‚
    â”‚          Client â”€â”€â”€â”€â”€â”€â†’â”‚             â”‚â†â”€â”€â”€â”€â”€â”€ Client            â”‚
    â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
    â”‚                                                                  â”‚
    â”‚   Problems:                                                      â”‚
    â”‚   â€¢ Single point of failure                                     â”‚
    â”‚   â€¢ Limited scalability                                         â”‚
    â”‚   â€¢ High latency for distant users                              â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    Distributed:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚   â”‚  Node   â”‚â†â”€â”€â”€â”€â”€â”€â”€â†’â”‚  Node   â”‚â†â”€â”€â”€â”€â”€â”€â”€â†’â”‚  Node   â”‚          â”‚
    â”‚   â”‚   A     â”‚         â”‚   B     â”‚         â”‚   C     â”‚          â”‚
    â”‚   â”‚(NYC)    â”‚         â”‚(London) â”‚         â”‚(Tokyo)  â”‚          â”‚
    â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â”‚
    â”‚        â”‚                   â”‚                   â”‚                â”‚
    â”‚        â†“                   â†“                   â†“                â”‚
    â”‚      Users               Users               Users              â”‚
    â”‚     (Americas)          (Europe)             (Asia)             â”‚
    â”‚                                                                  â”‚
    â”‚   Benefits:                                                      â”‚
    â”‚   â€¢ Local access (low latency)                                  â”‚
    â”‚   â€¢ Fault tolerance                                             â”‚
    â”‚   â€¢ Scalability                                                 â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    KEY CONCEPTS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   TRANSPARENCY: Hide distribution complexity from users         â”‚
    â”‚                                                                  â”‚
    â”‚   â€¢ Location transparency: Don't know where data is stored     â”‚
    â”‚   â€¢ Fragmentation transparency: Don't know data is split       â”‚
    â”‚   â€¢ Replication transparency: Don't know data is copied        â”‚
    â”‚   â€¢ Failure transparency: Don't know if nodes failed           â”‚
    â”‚                                                                  â”‚
    â”‚   Ideal: Distributed database looks like a single database     â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Data Fragmentation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA FRAGMENTATION                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Fragmentation divides a table across multiple sites.
    

    HORIZONTAL FRAGMENTATION:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Split by ROWS (different tuples at different sites).
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Original EMPLOYEES table:                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
    â”‚   â”‚ ID â”‚   Name   â”‚  Region   â”‚  Salary  â”‚                     â”‚
    â”‚   â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚
    â”‚   â”‚ 1  â”‚  Alice   â”‚  West     â”‚  70000   â”‚                     â”‚
    â”‚   â”‚ 2  â”‚  Bob     â”‚  East     â”‚  65000   â”‚                     â”‚
    â”‚   â”‚ 3  â”‚  Carol   â”‚  West     â”‚  80000   â”‚                     â”‚
    â”‚   â”‚ 4  â”‚  Dave    â”‚  East     â”‚  72000   â”‚                     â”‚
    â”‚   â”‚ 5  â”‚  Eve     â”‚  West     â”‚  68000   â”‚                     â”‚
    â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
    â”‚                                                                  â”‚
    â”‚   Fragmented by Region:                                          â”‚
    â”‚                                                                  â”‚
    â”‚   Site A (West Office):      Site B (East Office):             â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”         â”‚
    â”‚   â”‚ 1  â”‚  Alice   â”‚ 70000 â”‚  â”‚ 2  â”‚  Bob     â”‚ 65000 â”‚         â”‚
    â”‚   â”‚ 3  â”‚  Carol   â”‚ 80000 â”‚  â”‚ 4  â”‚  Dave    â”‚ 72000 â”‚         â”‚
    â”‚   â”‚ 5  â”‚  Eve     â”‚ 68000 â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
    â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
    â”‚                                                                  â”‚
    â”‚   Ïƒ(Region='West')(Employees) at Site A                        â”‚
    â”‚   Ïƒ(Region='East')(Employees) at Site B                        â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    
    Advantages:
    â€¢ Queries on local region don't need network access
    â€¢ Parallel processing of region-specific queries
    
    Rule: Fragments must be disjoint (no overlap)
          Union of fragments = original table


    VERTICAL FRAGMENTATION:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Split by COLUMNS (different attributes at different sites).
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Original EMPLOYEES table:                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   â”‚ ID â”‚   Name   â”‚  Salary   â”‚  SSN     â”‚  Medical   â”‚        â”‚
    â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                                                                  â”‚
    â”‚   Fragmented by access pattern:                                  â”‚
    â”‚                                                                  â”‚
    â”‚   Site A (HR System):        Site B (Payroll):                  â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚   â”‚ ID â”‚   Name   â”‚ Medicalâ”‚  â”‚ ID â”‚  Salary  â”‚   SSN    â”‚     â”‚
    â”‚   â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚                                                                  â”‚
    â”‚   Ï€(ID, Name, Medical)(Emp) at Site A                          â”‚
    â”‚   Ï€(ID, Salary, SSN)(Emp) at Site B                            â”‚
    â”‚                                                                  â”‚
    â”‚   Note: ID (primary key) must be in ALL fragments!             â”‚
    â”‚         Needed to reconstruct original via JOIN                 â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    
    Advantages:
    â€¢ Sensitive data (SSN) isolated at secure site
    â€¢ Frequently accessed columns grouped together
    â€¢ Reduces data transfer for column-specific queries


    HYBRID (MIXED) FRAGMENTATION:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Combine horizontal and vertical:                              â”‚
    â”‚                                                                  â”‚
    â”‚                    EMPLOYEES                                    â”‚
    â”‚                        â”‚                                        â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
    â”‚            â”‚ Vertical Split        â”‚                           â”‚
    â”‚            â”‚ (Columns)             â”‚                           â”‚
    â”‚            â†“                       â†“                            â”‚
    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
    â”‚      â”‚ ID, Name â”‚            â”‚ ID, Salaryâ”‚                     â”‚
    â”‚      â”‚ Region   â”‚            â”‚ SSN       â”‚                     â”‚
    â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚
    â”‚           â”‚                       â”‚                             â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                     â”‚
    â”‚    â”‚ Horizontal  â”‚         â”‚ Horizontal  â”‚                     â”‚
    â”‚    â”‚ (Rows)      â”‚         â”‚ (Rows)      â”‚                     â”‚
    â”‚    â†“             â†“         â†“             â†“                      â”‚
    â”‚  [West]       [East]    [West]       [East]                    â”‚
    â”‚  Site A       Site B    Site C       Site D                    â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Data Replication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA REPLICATION                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Replication stores COPIES of data at multiple sites.
    

    TYPES OF REPLICATION:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   FULL REPLICATION:                                             â”‚
    â”‚   Every site has complete copy of entire database               â”‚
    â”‚                                                                  â”‚
    â”‚   Site A          Site B          Site C                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
    â”‚   â”‚ Table 1  â”‚   â”‚ Table 1  â”‚   â”‚ Table 1  â”‚                   â”‚
    â”‚   â”‚ Table 2  â”‚   â”‚ Table 2  â”‚   â”‚ Table 2  â”‚                   â”‚
    â”‚   â”‚ Table 3  â”‚   â”‚ Table 3  â”‚   â”‚ Table 3  â”‚                   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
    â”‚       (copy)        (copy)         (copy)                       â”‚
    â”‚                                                                  â”‚
    â”‚   âœ“ Maximum read availability                                  â”‚
    â”‚   âœ— Very expensive updates (must update all copies)            â”‚
    â”‚   âœ— High storage cost                                          â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   PARTIAL REPLICATION:                                          â”‚
    â”‚   Some data replicated, some not                                â”‚
    â”‚                                                                  â”‚
    â”‚   Site A          Site B          Site C                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
    â”‚   â”‚ Table 1  â”‚   â”‚ Table 1  â”‚   â”‚ Table 2  â”‚                   â”‚
    â”‚   â”‚ Table 2  â”‚   â”‚ Table 3  â”‚   â”‚ Table 3  â”‚                   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
    â”‚                                                                  â”‚
    â”‚   Table 1: Sites A, B (2 copies)                               â”‚
    â”‚   Table 2: Sites A, C (2 copies)                               â”‚
    â”‚   Table 3: Sites B, C (2 copies)                               â”‚
    â”‚                                                                  â”‚
    â”‚   Most practical approach - replicate hot data                 â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   NO REPLICATION:                                               â”‚
    â”‚   Each piece of data at exactly one site                       â”‚
    â”‚                                                                  â”‚
    â”‚   Site A          Site B          Site C                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
    â”‚   â”‚ Table 1  â”‚   â”‚ Table 2  â”‚   â”‚ Table 3  â”‚                   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
    â”‚                                                                  â”‚
    â”‚   âœ“ No update synchronization needed                           â”‚
    â”‚   âœ— Single point of failure per table                         â”‚
    â”‚   âœ— Network access always required for remote data            â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    REPLICATION STRATEGIES:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   SYNCHRONOUS REPLICATION:                                      â”‚
    â”‚                                                                  â”‚
    â”‚   Client â†’ Primary â†’ All Replicas â†’ Commit â†’ Acknowledge       â”‚
    â”‚                                                                  â”‚
    â”‚   Write waits until ALL replicas updated                       â”‚
    â”‚   âœ“ Strong consistency                                         â”‚
    â”‚   âœ— High latency (slowest replica determines speed)           â”‚
    â”‚                                                                  â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                                                  â”‚
    â”‚   ASYNCHRONOUS REPLICATION:                                     â”‚
    â”‚                                                                  â”‚
    â”‚   Client â†’ Primary â†’ Acknowledge â†’ Later: replicate to others  â”‚
    â”‚                                                                  â”‚
    â”‚   Write returns after primary update                           â”‚
    â”‚   âœ“ Low latency                                                â”‚
    â”‚   âœ— Eventual consistency (replicas may lag)                   â”‚
    â”‚   âœ— Risk of data loss if primary fails before replication     â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Distributed Query Processing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DISTRIBUTED QUERY PROCESSING                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Queries must be processed across multiple sites.
    Major cost: DATA TRANSFER over network.
    

    QUERY PROCESSING STEPS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   1. Query Decomposition                                        â”‚
    â”‚      Parse query, convert to relational algebra                 â”‚
    â”‚                                                                  â”‚
    â”‚   2. Data Localization                                          â”‚
    â”‚      Determine which sites have needed data                     â”‚
    â”‚                                                                  â”‚
    â”‚   3. Global Optimization                                        â”‚
    â”‚      Minimize total cost (local processing + transfer)          â”‚
    â”‚                                                                  â”‚
    â”‚   4. Local Optimization                                         â”‚
    â”‚      Each site optimizes its portion                            â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    COST MODEL:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    Total Cost = Î£(Local Processing) + Î£(Data Transfer)
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Local processing: CPU, disk I/O (relatively fast)            â”‚
    â”‚   Data transfer: Network communication (often dominant cost)   â”‚
    â”‚                                                                  â”‚
    â”‚   Network is 10-1000x slower than local disk!                  â”‚
    â”‚   â†’ Minimize data movement between sites                       â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    EXAMPLE: Distributed Join
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Query: SELECT * FROM Orders O, Customers C                   â”‚
    â”‚          WHERE O.cust_id = C.id                                â”‚
    â”‚                                                                  â”‚
    â”‚   Data location:                                                 â”‚
    â”‚   â€¢ Orders (100,000 rows, 100 bytes each) at Site A            â”‚
    â”‚   â€¢ Customers (10,000 rows, 200 bytes each) at Site B          â”‚
    â”‚                                                                  â”‚
    â”‚   Strategy 1: Ship Orders to Site B                            â”‚
    â”‚   Transfer: 100,000 Ã— 100 = 10 MB                              â”‚
    â”‚   Join at Site B                                                â”‚
    â”‚                                                                  â”‚
    â”‚   Strategy 2: Ship Customers to Site A                         â”‚
    â”‚   Transfer: 10,000 Ã— 200 = 2 MB                                â”‚
    â”‚   Join at Site A                                                â”‚
    â”‚                                                                  â”‚
    â”‚   Strategy 3: Semi-join                                         â”‚
    â”‚   1. Project O.cust_id at A, send to B (10KB distinct IDs)    â”‚
    â”‚   2. Join with C at B, send matching C to A (selected rows)   â”‚
    â”‚   3. Complete join at A                                        â”‚
    â”‚   Transfer: Much less if only some customers have orders!      â”‚
    â”‚                                                                  â”‚
    â”‚   â†’ Strategy 2 or 3 typically best                             â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    SEMI-JOIN TECHNIQUE:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Reduce data transfer by sending only relevant data:          â”‚
    â”‚                                                                  â”‚
    â”‚   Site A                         Site B                         â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
    â”‚   â”‚ Orders  â”‚                   â”‚Customersâ”‚                    â”‚
    â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â”‚
    â”‚        â”‚                              â”‚                        â”‚
    â”‚        â”‚ 1. Ï€(cust_id)(Orders)       â”‚                        â”‚
    â”‚        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                        â”‚
    â”‚        â”‚                              â”‚                        â”‚
    â”‚        â”‚                        2. Semi-join:                  â”‚
    â”‚        â”‚                           C â‹‰ cust_ids                â”‚
    â”‚        â”‚                              â”‚                        â”‚
    â”‚        â”‚ 3. Matching Customers only  â”‚                        â”‚
    â”‚        â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
    â”‚        â”‚                              â”‚                        â”‚
    â”‚   4. Join Orders with                                          â”‚
    â”‚      received Customers                                         â”‚
    â”‚        â”‚                                                        â”‚
    â”‚        â†“                                                        â”‚
    â”‚     Result                                                      â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Distributed Transactions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DISTRIBUTED TRANSACTIONS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    A distributed transaction accesses data at multiple sites.
    Challenge: Ensure ATOMICITY across all sites.
    

    THE PROBLEM:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Transaction: Transfer $100 from Account A to Account B       â”‚
    â”‚                                                                  â”‚
    â”‚   Site 1: Account A (NYC)     Site 2: Account B (London)       â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
    â”‚   Debit A by $100             Credit B by $100                  â”‚
    â”‚                                                                  â”‚
    â”‚   What if:                                                       â”‚
    â”‚   â€¢ Site 1 commits, Site 2 crashes before commit?              â”‚
    â”‚   â€¢ Network fails between the two operations?                  â”‚
    â”‚                                                                  â”‚
    â”‚   Money disappears! Atomicity violated.                        â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    TWO-PHASE COMMIT (2PC):
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚                     COORDINATOR                                  â”‚
    â”‚                    (Transaction Manager)                         â”‚
    â”‚                          â”‚                                       â”‚
    â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
    â”‚            â”‚             â”‚             â”‚                        â”‚
    â”‚            â†“             â†“             â†“                        â”‚
    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
    â”‚       â”‚ Site A  â”‚   â”‚ Site B  â”‚   â”‚ Site C  â”‚                  â”‚
    â”‚       â”‚(Participâ”‚   â”‚(Participâ”‚   â”‚(Participâ”‚                  â”‚
    â”‚       â”‚  ant)   â”‚   â”‚  ant)   â”‚   â”‚  ant)   â”‚                  â”‚
    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    
    PHASE 1: PREPARE (Voting Phase)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Coordinator                 Participants                       â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â”€â”€â”€â”€ PREPARE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                             â”‚
    â”‚       â”‚      (Can you commit?)    â”‚                             â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚                      [Execute transaction locally]      â”‚
    â”‚       â”‚                      [Write to log]                     â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â†â”€â”€â”€â”€ VOTE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
    â”‚       â”‚   (YES or NO)             â”‚                             â”‚
    â”‚                                                                  â”‚
    â”‚   If participant votes YES:                                     â”‚
    â”‚   â€¢ Must be able to commit or abort                            â”‚
    â”‚   â€¢ Has logged all changes                                      â”‚
    â”‚   â€¢ Holds locks until final decision                           â”‚
    â”‚                                                                  â”‚
    â”‚   If participant votes NO:                                      â”‚
    â”‚   â€¢ Cannot commit (constraint violation, failure, etc.)        â”‚
    â”‚   â€¢ Can immediately abort locally                               â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    
    PHASE 2: COMMIT/ABORT (Decision Phase)
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   If ALL votes = YES:                                           â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
    â”‚   Coordinator                 Participants                       â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â”€â”€â”€â”€ COMMIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                             â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚                      [Commit locally]                   â”‚
    â”‚       â”‚                      [Release locks]                    â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â†â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
    â”‚                                                                  â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                                                                  â”‚
    â”‚   If ANY vote = NO:                                             â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
    â”‚   Coordinator                 Participants                       â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â”€â”€â”€â”€ ABORT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚                             â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚                      [Rollback locally]                 â”‚
    â”‚       â”‚                      [Release locks]                    â”‚
    â”‚       â”‚                           â”‚                             â”‚
    â”‚       â”‚â†â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    2PC TIMELINE:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
        Coordinator         Site A           Site B
            â”‚                 â”‚                â”‚
            â”‚                 â”‚                â”‚
            â”‚â”€â”€ PREPARE â”€â”€â”€â”€â”€â†’â”‚                â”‚
            â”‚â”€â”€ PREPARE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
            â”‚                 â”‚                â”‚
            â”‚                 â”‚ work...       â”‚ work...
            â”‚                 â”‚                â”‚
            â”‚â†â”€â”€ YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
            â”‚â†â”€â”€ YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
            â”‚                 â”‚                â”‚
            â”‚ (all YES)       â”‚                â”‚
            â”‚                 â”‚                â”‚
            â”‚â”€â”€ COMMIT â”€â”€â”€â”€â”€â”€â†’â”‚                â”‚
            â”‚â”€â”€ COMMIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
            â”‚                 â”‚                â”‚
            â”‚â†â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
            â”‚â†â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
            â”‚                 â”‚                â”‚
           Done              Done             Done


    2PC ISSUES:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   BLOCKING: If coordinator fails after PREPARE:                â”‚
    â”‚   â€¢ Participants who voted YES are stuck                       â”‚
    â”‚   â€¢ Cannot commit (might others abort?)                        â”‚
    â”‚   â€¢ Cannot abort (might coordinator committed?)                â”‚
    â”‚   â€¢ Must WAIT for coordinator recovery                         â”‚
    â”‚                                                                  â”‚
    â”‚   Solution: Three-phase commit (3PC) - adds pre-commit phase  â”‚
    â”‚             Reduces blocking but more complex                   â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. CAP Theorem

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAP THEOREM                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    CAP Theorem (Brewer, 2000): A distributed system can provide
    at most TWO of three guarantees simultaneously.
    

    THE THREE PROPERTIES:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   C - CONSISTENCY:                                              â”‚
    â”‚       All nodes see the same data at the same time             â”‚
    â”‚       Every read receives the most recent write                â”‚
    â”‚                                                                  â”‚
    â”‚   A - AVAILABILITY:                                             â”‚
    â”‚       Every request receives a response (success or failure)   â”‚
    â”‚       System remains operational                                â”‚
    â”‚                                                                  â”‚
    â”‚   P - PARTITION TOLERANCE:                                      â”‚
    â”‚       System continues despite network failures                 â”‚
    â”‚       Messages between nodes can be lost or delayed            â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    THE TRADE-OFF:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚                         C                                       â”‚
    â”‚                        /â”‚\                                      â”‚
    â”‚                       / â”‚ \                                     â”‚
    â”‚                      /  â”‚  \                                    â”‚
    â”‚                     /   â”‚   \                                   â”‚
    â”‚                    /    â”‚    \                                  â”‚
    â”‚                   /     â”‚     \                                 â”‚
    â”‚                  /   CP â”‚ CA   \                                â”‚
    â”‚                 /       â”‚       \                               â”‚
    â”‚                /â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€\                              â”‚
    â”‚               P         â”‚         A                             â”‚
    â”‚                         â”‚                                       â”‚
    â”‚                        AP                                       â”‚
    â”‚                                                                  â”‚
    â”‚   Choose 2:                                                      â”‚
    â”‚   â€¢ CP: Consistent + Partition-tolerant (sacrifice Availability)â”‚
    â”‚   â€¢ AP: Available + Partition-tolerant (sacrifice Consistency) â”‚
    â”‚   â€¢ CA: Consistent + Available (only if no partitions - rare)  â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    NETWORK PARTITION SCENARIO:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Normal operation:          Partition occurs:                   â”‚
    â”‚                                                                  â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â” â•³ â•³ â”Œâ”€â”€â”€â”€â”€â”               â”‚
    â”‚   â”‚Node â”‚â†â†’â”‚Node â”‚         â”‚Node â”‚ â•³ â•³ â”‚Node â”‚               â”‚
    â”‚   â”‚  A  â”‚   â”‚  B  â”‚         â”‚  A  â”‚     â”‚  B  â”‚               â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                              (cannot communicate)               â”‚
    â”‚                                                                  â”‚
    â”‚   Client wants to write X=5:                                    â”‚
    â”‚                                                                  â”‚
    â”‚   CP System:                      AP System:                    â”‚
    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
    â”‚   "Sorry, cannot write.          "OK, written to Node A."      â”‚
    â”‚    Cannot guarantee               Node B still has old value.  â”‚
    â”‚    consistency."                  Eventually will sync.        â”‚
    â”‚                                                                  â”‚
    â”‚   (Sacrifices Availability)       (Sacrifices Consistency)     â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    REAL SYSTEMS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      System        â”‚           CAP Choice                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ Traditional RDBMS  â”‚ CA (single node) or CP (distributed)    â”‚
    â”‚ MongoDB            â”‚ CP (strong consistency mode)            â”‚
    â”‚ Cassandra          â”‚ AP (tunable consistency)                â”‚
    â”‚ DynamoDB           â”‚ AP (eventually consistent by default)   â”‚
    â”‚ Spanner (Google)   â”‚ CP (globally consistent)                â”‚
    â”‚ CockroachDB        â”‚ CP (serializable isolation)             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    CONSISTENCY MODELS:
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                  â”‚
    â”‚   Strong Consistency:                                           â”‚
    â”‚   After write completes, all reads return that value           â”‚
    â”‚   (As if single copy exists)                                   â”‚
    â”‚                                                                  â”‚
    â”‚   Eventual Consistency:                                         â”‚
    â”‚   If no new writes, eventually all reads return same value    â”‚
    â”‚   (May read stale data temporarily)                            â”‚
    â”‚                                                                  â”‚
    â”‚   Causal Consistency:                                           â”‚
    â”‚   Causally related operations seen in same order everywhere   â”‚
    â”‚   (Weaker than strong, stronger than eventual)                 â”‚
    â”‚                                                                  â”‚
    â”‚   Read-Your-Writes:                                             â”‚
    â”‚   A process always sees its own writes                         â”‚
    â”‚   (Others may not see them yet)                                â”‚
    â”‚                                                                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Summary Table

| Fragmentation Type | How Data Split | Use Case |
|--------------------|----------------|----------|
| **Horizontal** | By rows (conditions) | Regional data |
| **Vertical** | By columns (attributes) | Security, access patterns |
| **Hybrid** | Both | Complex requirements |

| Replication Type | Copies | Trade-off |
|------------------|--------|-----------|
| **Full** | All data everywhere | High availability, costly updates |
| **Partial** | Hot data replicated | Balanced |
| **None** | Single copy | Simple but single point of failure |

| CAP Choice | Sacrifices | Example Systems |
|------------|------------|-----------------|
| **CP** | Availability | MongoDB, Spanner |
| **AP** | Consistency | Cassandra, DynamoDB |
| **CA** | Partition Tolerance | Single-node RDBMS |

---

## â“ Quick Revision Questions

1. **What is location transparency in distributed databases?**
   <details>
   <summary>Click for Answer</summary>
   Location transparency means users and applications don't need to know where data is physically stored. Queries reference tables by name; the system locates the data across sites automatically. The distributed database appears as a single logical database regardless of physical distribution.
   </details>

2. **Why must vertical fragments include the primary key?**
   <details>
   <summary>Click for Answer</summary>
   The primary key is needed to reconstruct the original relation by joining the fragments. Without a common attribute, we couldn't match which rows from Fragment 1 go with which rows from Fragment 2. The key allows: Original = Fragment1 â‹ˆ Fragment2 â‹ˆ ... FragmentN.
   </details>

3. **Why is network transfer often the dominant cost in distributed queries?**
   <details>
   <summary>Click for Answer</summary>
   Network transfer is 10-1000x slower than local disk access due to bandwidth limitations and latency. Moving 1GB over network might take seconds, while local disk reads the same in milliseconds. Optimizers therefore minimize data movement - ship smaller relations, use semi-joins, push operations to data locations.
   </details>

4. **What happens if the coordinator crashes during 2PC after sending PREPARE?**
   <details>
   <summary>Click for Answer</summary>
   Participants who voted YES are blocked. They can't commit (maybe coordinator decided to abort) or abort (maybe coordinator committed and other sites committed). They must hold locks and wait for coordinator recovery. This blocking problem is 2PC's main weakness, addressed partially by 3PC.
   </details>

5. **What does "partition tolerance" mean in CAP theorem?**
   <details>
   <summary>Click for Answer</summary>
   Partition tolerance means the system continues operating despite arbitrary message loss or failure between nodes. A network partition splits the system into isolated groups that can't communicate. Since partitions can always happen in distributed systems, we effectively choose between C and A during partitions.
   </details>

6. **What is eventual consistency and when is it acceptable?**
   <details>
   <summary>Click for Answer</summary>
   Eventual consistency guarantees that if no new updates are made, all replicas will eventually converge to the same value. It's acceptable when: (1) temporary staleness is tolerable (social media likes), (2) high availability is critical, (3) conflicts are rare or resolvable. Not acceptable for banking or inventory where stale reads cause real problems.
   </details>

---

## ğŸ”— Navigation

| Previous | Up | Next |
|----------|----|----|
| [â† Query Optimization](../07-Query-Processing/02-query-optimization.md) | [ğŸ“š Table of Contents](../README.md) | [NoSQL Databases â†’](02-nosql-databases.md) |

---

*Last Updated: January 2026*
