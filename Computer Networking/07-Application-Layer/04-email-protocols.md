# Chapter 7.4: Email Protocols

[â† Back to Table of Contents](../README.md)

---

## ğŸ“š Chapter Overview

Electronic mail is one of the oldest and most important Internet applications. This chapter covers the architecture of email systems and the protocols that make email work: SMTP for sending, and POP3/IMAP for retrieving messages.

---

## ğŸ¯ Learning Objectives

- Understand email system architecture and components
- Learn how SMTP sends emails between servers
- Compare POP3 and IMAP for email retrieval
- Understand email message format (MIME)

---

## 1. Email System Architecture

### Email Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMAIL SYSTEM ARCHITECTURE                        â”‚
â”‚                                                                     â”‚
â”‚    Three main components in email system                           â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  1. USER AGENTS (UA) - Email Clients                        â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Composing, reading, replying to email             â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Examples: Outlook, Gmail (web), Thunderbird       â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Also called "mail reader"                         â”‚ â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  2. MAIL SERVERS                                            â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Store incoming messages in mailboxes              â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Send outgoing messages to other servers           â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Run 24/7                                          â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ Have message queues for retrying                  â”‚ â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  3. PROTOCOLS                                               â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ SMTP: Send mail (server to server)                â”‚ â”‚ â”‚
â”‚    â”‚     â”‚ â€¢ POP3/IMAP: Retrieve mail (client from server)     â”‚ â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    COMPLETE EMAIL FLOW:                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚   alice@a.com sends to bob@b.com                            â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚   [Alice's UA]                                              â”‚ â”‚
â”‚    â”‚       â”‚                                                      â”‚ â”‚
â”‚    â”‚       â”‚ SMTP (or HTTP for webmail)                          â”‚ â”‚
â”‚    â”‚       â–¼                                                      â”‚ â”‚
â”‚    â”‚   [Alice's Mail Server]                                     â”‚ â”‚
â”‚    â”‚   (mail.a.com)                                              â”‚ â”‚
â”‚    â”‚       â”‚                                                      â”‚ â”‚
â”‚    â”‚       â”‚ SMTP (server-to-server)                             â”‚ â”‚
â”‚    â”‚       â–¼                                                      â”‚ â”‚
â”‚    â”‚   [Bob's Mail Server]                                       â”‚ â”‚
â”‚    â”‚   (mail.b.com)                                              â”‚ â”‚
â”‚    â”‚       â”‚                                                      â”‚ â”‚
â”‚    â”‚       â”‚ POP3 or IMAP                                        â”‚ â”‚
â”‚    â”‚       â–¼                                                      â”‚ â”‚
â”‚    â”‚   [Bob's UA]                                                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. SMTP Protocol

### Simple Mail Transfer Protocol

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SMTP - SIMPLE MAIL TRANSFER PROTOCOL             â”‚
â”‚                                                                     â”‚
â”‚    The protocol for SENDING email                                  â”‚
â”‚                                                                     â”‚
â”‚    KEY FEATURES:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ Port 25 (server-to-server) or 587 (client-to-server)    â”‚ â”‚
â”‚    â”‚  â€¢ Uses TCP (reliable delivery needed)                      â”‚ â”‚
â”‚    â”‚  â€¢ PUSH protocol (sender initiates)                         â”‚ â”‚
â”‚    â”‚  â€¢ Text-based, human-readable commands                      â”‚ â”‚
â”‚    â”‚  â€¢ Originally 7-bit ASCII only (now extended with MIME)     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    SMTP vs HTTP:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚    â”‚      SMTP        â”‚      HTTP        â”‚                         â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
â”‚    â”‚ Push protocol    â”‚ Pull protocol    â”‚                         â”‚
â”‚    â”‚ (sender pushes)  â”‚ (client pulls)   â”‚                         â”‚
â”‚    â”‚ Multiple objects â”‚ Each object in   â”‚                         â”‚
â”‚    â”‚ in one message   â”‚ own response     â”‚                         â”‚
â”‚    â”‚ 7-bit ASCII      â”‚ 8-bit binary OK  â”‚                         â”‚
â”‚    â”‚ Port 25/587      â”‚ Port 80/443      â”‚                         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SMTP Conversation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SMTP CONVERSATION EXAMPLE                        â”‚
â”‚                                                                     â”‚
â”‚    Sending email from alice@crepes.fr to bob@hamburger.edu         â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [Client: mail.crepes.fr]        [Server: mail.hamburger.edu]â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  1. TCP connection to port 25                               â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     220 hamburger.edu SMTP service ready                    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  2. HELO crepes.fr                                          â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     250 Hello crepes.fr, pleased to meet you                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  3. MAIL FROM: <alice@crepes.fr>                            â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     250 OK                                                   â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  4. RCPT TO: <bob@hamburger.edu>                            â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     250 OK                                                   â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  5. DATA                                                     â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     354 Start mail input; end with <CRLF>.<CRLF>            â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  6. From: alice@crepes.fr                                   â”‚ â”‚
â”‚    â”‚     To: bob@hamburger.edu                                   â”‚ â”‚
â”‚    â”‚     Subject: Hello!                                         â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     Hi Bob, how are you?                                    â”‚ â”‚
â”‚    â”‚     .                                                        â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     250 Message accepted for delivery                       â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  7. QUIT                                                     â”‚ â”‚
â”‚    â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ â”‚
â”‚    â”‚     221 Bye                                                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    SMTP COMMANDS:                                                   â”‚
â”‚    â€¢ HELO/EHLO: Introduce sender                                   â”‚
â”‚    â€¢ MAIL FROM: Sender's address                                   â”‚
â”‚    â€¢ RCPT TO: Recipient's address                                  â”‚
â”‚    â€¢ DATA: Start message content                                   â”‚
â”‚    â€¢ QUIT: End session                                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Email Message Format

### RFC 5322 and MIME

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMAIL MESSAGE FORMAT                             â”‚
â”‚                                                                     â”‚
â”‚    RFC 5322: Basic text email format                               â”‚
â”‚    MIME: Extends for attachments, non-ASCII                        â”‚
â”‚                                                                     â”‚
â”‚    MESSAGE STRUCTURE:                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚    â”‚  â”‚  HEADER SECTION                                         â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â”‚  From: Alice Smith <alice@example.com>                  â”‚â”‚ â”‚
â”‚    â”‚  â”‚  To: Bob Jones <bob@example.com>                        â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Subject: Meeting Tomorrow                              â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Date: Mon, 15 Jan 2025 10:00:00 -0500                  â”‚â”‚ â”‚
â”‚    â”‚  â”‚  MIME-Version: 1.0                                      â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Content-Type: multipart/mixed; boundary="----=_Part"  â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  <blank line>                                               â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚    â”‚  â”‚  BODY SECTION                                           â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Hi Bob,                                                â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Let's meet tomorrow at 2pm.                            â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Best,                                                  â”‚â”‚ â”‚
â”‚    â”‚  â”‚  Alice                                                  â”‚â”‚ â”‚
â”‚    â”‚  â”‚                                                          â”‚â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    MIME (Multipurpose Internet Mail Extensions):                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Allows email to contain:                                   â”‚ â”‚
â”‚    â”‚  â€¢ Non-ASCII text (international characters)                â”‚ â”‚
â”‚    â”‚  â€¢ Attachments (images, documents, etc.)                    â”‚ â”‚
â”‚    â”‚  â€¢ Multiple parts (text + attachment)                       â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  MIME Headers:                                               â”‚ â”‚
â”‚    â”‚  â€¢ MIME-Version: 1.0                                        â”‚ â”‚
â”‚    â”‚  â€¢ Content-Type: type/subtype                               â”‚ â”‚
â”‚    â”‚  â€¢ Content-Transfer-Encoding: base64, quoted-printable     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Common Content-Types:                                       â”‚ â”‚
â”‚    â”‚  â€¢ text/plain                                               â”‚ â”‚
â”‚    â”‚  â€¢ text/html                                                â”‚ â”‚
â”‚    â”‚  â€¢ image/jpeg, image/png                                    â”‚ â”‚
â”‚    â”‚  â€¢ application/pdf                                          â”‚ â”‚
â”‚    â”‚  â€¢ multipart/mixed (multiple parts)                         â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. POP3 Protocol

### Post Office Protocol Version 3

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POP3 - POST OFFICE PROTOCOL                      â”‚
â”‚                                                                     â”‚
â”‚    Simple protocol to RETRIEVE email from server                   â”‚
â”‚                                                                     â”‚
â”‚    KEY FEATURES:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ Port 110 (or 995 for POP3S with SSL)                     â”‚ â”‚
â”‚    â”‚  â€¢ Uses TCP                                                  â”‚ â”‚
â”‚    â”‚  â€¢ Download-and-delete model (typically)                    â”‚ â”‚
â”‚    â”‚  â€¢ Simple, stateless between sessions                       â”‚ â”‚
â”‚    â”‚  â€¢ Emails stored locally after download                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    POP3 SESSION PHASES:                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  1. AUTHORIZATION PHASE                                     â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚     â”‚ USER bob                                         â”‚    â”‚ â”‚
â”‚    â”‚     â”‚ PASS secretpassword                              â”‚    â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  2. TRANSACTION PHASE                                       â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚     â”‚ LIST - List messages and sizes                   â”‚    â”‚ â”‚
â”‚    â”‚     â”‚ RETR 1 - Retrieve message 1                      â”‚    â”‚ â”‚
â”‚    â”‚     â”‚ DELE 1 - Mark message 1 for deletion             â”‚    â”‚ â”‚
â”‚    â”‚     â”‚ STAT - Get mailbox statistics                    â”‚    â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  3. UPDATE PHASE                                            â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚     â”‚ QUIT - End session, actually delete messages     â”‚    â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    POP3 CONVERSATION:                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  S: +OK POP3 server ready                                   â”‚ â”‚
â”‚    â”‚  C: USER bob                                                â”‚ â”‚
â”‚    â”‚  S: +OK                                                      â”‚ â”‚
â”‚    â”‚  C: PASS secret                                             â”‚ â”‚
â”‚    â”‚  S: +OK user logged in                                      â”‚ â”‚
â”‚    â”‚  C: LIST                                                     â”‚ â”‚
â”‚    â”‚  S: +OK 2 messages                                          â”‚ â”‚
â”‚    â”‚  S: 1 1500                                                   â”‚ â”‚
â”‚    â”‚  S: 2 2340                                                   â”‚ â”‚
â”‚    â”‚  S: .                                                        â”‚ â”‚
â”‚    â”‚  C: RETR 1                                                   â”‚ â”‚
â”‚    â”‚  S: +OK                                                      â”‚ â”‚
â”‚    â”‚  S: (message content...)                                    â”‚ â”‚
â”‚    â”‚  S: .                                                        â”‚ â”‚
â”‚    â”‚  C: DELE 1                                                   â”‚ â”‚
â”‚    â”‚  S: +OK                                                      â”‚ â”‚
â”‚    â”‚  C: QUIT                                                     â”‚ â”‚
â”‚    â”‚  S: +OK bye                                                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    MODES:                                                           â”‚
â”‚    â€¢ Download-and-delete: Remove from server after download        â”‚
â”‚    â€¢ Download-and-keep: Leave copy on server                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. IMAP Protocol

### Internet Message Access Protocol

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IMAP - INTERNET MESSAGE ACCESS PROTOCOL          â”‚
â”‚                                                                     â”‚
â”‚    More sophisticated email access protocol                        â”‚
â”‚                                                                     â”‚
â”‚    KEY FEATURES:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ Port 143 (or 993 for IMAPS with SSL)                     â”‚ â”‚
â”‚    â”‚  â€¢ Messages STAY on server                                  â”‚ â”‚
â”‚    â”‚  â€¢ Folder management (Inbox, Sent, Drafts, etc.)           â”‚ â”‚
â”‚    â”‚  â€¢ Partial fetch (headers only, or specific parts)         â”‚ â”‚
â”‚    â”‚  â€¢ Search capability on server                              â”‚ â”‚
â”‚    â”‚  â€¢ Synchronization across devices                           â”‚ â”‚
â”‚    â”‚  â€¢ More complex than POP3                                   â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    IMAP FOLDER HIERARCHY:                                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚                    MAILBOX                                   â”‚ â”‚
â”‚    â”‚                       â”‚                                      â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚    â”‚    â”‚                  â”‚                  â”‚                  â”‚ â”‚
â”‚    â”‚    â–¼                  â–¼                  â–¼                  â”‚ â”‚
â”‚    â”‚  INBOX              Sent              Drafts                â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â”œâ”€â”€ Work                                                  â”‚ â”‚
â”‚    â”‚    â”‚    â”œâ”€â”€ Project A                                       â”‚ â”‚
â”‚    â”‚    â”‚    â””â”€â”€ Project B                                       â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â””â”€â”€ Personal                                              â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  All managed on SERVER, synced to all devices               â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    IMAP COMMANDS:                                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ LOGIN username password                                  â”‚ â”‚
â”‚    â”‚  â€¢ SELECT INBOX - Open folder                               â”‚ â”‚
â”‚    â”‚  â€¢ FETCH 1 BODY[] - Get complete message                    â”‚ â”‚
â”‚    â”‚  â€¢ FETCH 1 BODY[HEADER] - Get headers only                  â”‚ â”‚
â”‚    â”‚  â€¢ SEARCH FROM "alice" - Search messages                    â”‚ â”‚
â”‚    â”‚  â€¢ CREATE "Work/ProjectC" - Create folder                   â”‚ â”‚
â”‚    â”‚  â€¢ COPY 1 "Archive" - Copy message to folder                â”‚ â”‚
â”‚    â”‚  â€¢ STORE 1 +FLAGS (\Seen) - Mark as read                    â”‚ â”‚
â”‚    â”‚  â€¢ EXPUNGE - Permanently delete marked messages             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### POP3 vs IMAP Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POP3 vs IMAP                                     â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚        POP3         â”‚        IMAP         â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Port 110/995        â”‚ Port 143/993        â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Download to local   â”‚ Keep on server      â”‚                   â”‚
â”‚    â”‚ (delete from server)â”‚ (sync everywhere)   â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Simple              â”‚ More complex        â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ No folders on serverâ”‚ Server-side folders â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Can't partial fetch â”‚ Fetch parts/headers â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ No server search    â”‚ Server-side search  â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Single device ideal â”‚ Multiple devices    â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Low bandwidth use   â”‚ More bandwidth      â”‚                   â”‚
â”‚    â”‚ after download      â”‚ (ongoing sync)      â”‚                   â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚    â”‚ Works offline       â”‚ Needs connection    â”‚                   â”‚
â”‚    â”‚ after download      â”‚ for full features   â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                     â”‚
â”‚    MODERN USAGE:                                                    â”‚
â”‚    â€¢ IMAP preferred for multi-device access                        â”‚
â”‚    â€¢ Webmail (Gmail, Outlook.com) uses HTTP/HTTPS                  â”‚
â”‚    â€¢ Many services support all three access methods                â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Modern Email Security

### Email Security Extensions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EMAIL SECURITY                                   â”‚
â”‚                                                                     â”‚
â”‚    Original email had NO security - plain text!                    â”‚
â”‚                                                                     â”‚
â”‚    TRANSPORT SECURITY:                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  STARTTLS: Upgrade connection to TLS                        â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚  â”‚  1. Connect to port 25/143                          â”‚    â”‚ â”‚
â”‚    â”‚  â”‚  2. STARTTLS command                                â”‚    â”‚ â”‚
â”‚    â”‚  â”‚  3. Upgrade to encrypted connection                 â”‚    â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Dedicated TLS ports:                                       â”‚ â”‚
â”‚    â”‚  â€¢ SMTPS: Port 465                                          â”‚ â”‚
â”‚    â”‚  â€¢ POP3S: Port 995                                          â”‚ â”‚
â”‚    â”‚  â€¢ IMAPS: Port 993                                          â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    AUTHENTICATION:                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  SPF (Sender Policy Framework):                             â”‚ â”‚
â”‚    â”‚  â€¢ DNS record specifying authorized mail servers            â”‚ â”‚
â”‚    â”‚  â€¢ "Only these IPs can send for our domain"                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  DKIM (DomainKeys Identified Mail):                         â”‚ â”‚
â”‚    â”‚  â€¢ Digital signature in email header                        â”‚ â”‚
â”‚    â”‚  â€¢ Proves email wasn't modified in transit                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  DMARC (Domain-based Message Authentication):               â”‚ â”‚
â”‚    â”‚  â€¢ Policy for handling SPF/DKIM failures                    â”‚ â”‚
â”‚    â”‚  â€¢ "Reject/quarantine emails that fail authentication"     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Summary Table

| Protocol | Port | Purpose | Direction |
|----------|------|---------|-----------|
| **SMTP** | 25, 587, 465 | Send email | Clientâ†’Server, Serverâ†’Server |
| **POP3** | 110, 995 | Download email | Serverâ†’Client |
| **IMAP** | 143, 993 | Sync email | Serverâ†”Client |

| Feature | POP3 | IMAP |
|---------|------|------|
| **Storage** | Local | Server |
| **Folders** | No | Yes |
| **Multi-device** | Poor | Excellent |
| **Partial fetch** | No | Yes |
| **Complexity** | Simple | Complex |

---

## â“ Quick Revision Questions

1. **Q:** What are the three main components of an email system?
   <details>
   <summary>Answer</summary>
   1. **User Agents (UA)**:
      - Email clients (Outlook, Thunderbird, Gmail)
      - Compose, read, reply to emails
   
   2. **Mail Servers**:
      - Store messages in mailboxes
      - Send outgoing mail
      - Run continuously
   
   3. **Protocols**:
      - SMTP: Send mail (push)
      - POP3/IMAP: Retrieve mail (pull)
   </details>

2. **Q:** What is SMTP and what port does it use?
   <details>
   <summary>Answer</summary>
   **SMTP** = Simple Mail Transfer Protocol
   
   - Protocol for **sending** email
   - Uses TCP (reliable delivery)
   - **Ports**:
     - 25: Server-to-server
     - 587: Client-to-server (submission)
     - 465: SMTPS (with SSL/TLS)
   
   - Push protocol (sender initiates)
   - Originally 7-bit ASCII only
   - Text-based commands (HELO, MAIL FROM, RCPT TO, DATA, QUIT)
   </details>

3. **Q:** List the main SMTP commands and their purposes.
   <details>
   <summary>Answer</summary>
   | Command | Purpose |
   |---------|---------|
   | HELO/EHLO | Identify sender server |
   | MAIL FROM: | Specify sender address |
   | RCPT TO: | Specify recipient address |
   | DATA | Start message content |
   | QUIT | End session |
   | RSET | Reset/cancel current mail |
   | VRFY | Verify user exists |
   | NOOP | No operation (keep alive) |
   
   Data ends with a line containing only a period (.)
   </details>

4. **Q:** Compare POP3 and IMAP.
   <details>
   <summary>Answer</summary>
   | Aspect | POP3 | IMAP |
   |--------|------|------|
   | Port | 110/995 | 143/993 |
   | Storage | Download to local | Keep on server |
   | Folders | No server folders | Server folders |
   | Sync | No | Yes (multi-device) |
   | Partial fetch | No | Yes |
   | Search | Local only | Server-side |
   | Complexity | Simple | Complex |
   
   **Use POP3**: Single device, offline access
   **Use IMAP**: Multiple devices, sync needed
   </details>

5. **Q:** What is MIME and why is it needed?
   <details>
   <summary>Answer</summary>
   **MIME** = Multipurpose Internet Mail Extensions
   
   **Why needed**:
   - Original SMTP only supported 7-bit ASCII
   - Couldn't send attachments
   - Couldn't send non-English text
   
   **MIME allows**:
   - Binary attachments (images, PDFs)
   - Non-ASCII text (international characters)
   - Multiple message parts
   - HTML email
   
   **Key headers**:
   - MIME-Version: 1.0
   - Content-Type: type/subtype
   - Content-Transfer-Encoding: base64
   </details>

6. **Q:** What are SPF, DKIM, and DMARC?
   <details>
   <summary>Answer</summary>
   **SPF** (Sender Policy Framework):
   - DNS TXT record
   - Lists authorized sending servers
   - "Only these IPs can send for us"
   
   **DKIM** (DomainKeys Identified Mail):
   - Digital signature in header
   - Proves email wasn't modified
   - Uses public/private key pair
   
   **DMARC** (Domain-based Message Authentication):
   - Policy layer on SPF/DKIM
   - Tells receivers what to do on failure
   - Options: none, quarantine, reject
   
   Together they fight email spoofing and phishing.
   </details>

---

## ğŸ”— Navigation

| Previous | Up | Next |
|----------|-----|------|
| [â† HTTP Protocol](03-http-protocol.md) | [Table of Contents](../README.md) | [FTP and DHCP â†’](05-ftp-dhcp.md) |

---

*Â© 2025 Computer Networking Study Notes. For educational purposes.*
