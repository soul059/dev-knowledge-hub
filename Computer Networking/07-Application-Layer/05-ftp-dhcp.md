# Chapter 7.5: FTP and DHCP

[â† Back to Table of Contents](../README.md)

---

## ğŸ“š Chapter Overview

This chapter covers two essential application layer protocols: FTP for file transfer and DHCP for automatic network configuration. FTP enables reliable file transfers between hosts, while DHCP automatically assigns IP addresses and network settings.

---

## ğŸ¯ Learning Objectives

- Understand FTP's dual-connection architecture
- Learn FTP commands and modes
- Master DHCP's four-step configuration process
- Understand IP address leasing and renewal

---

## 1. FTP - File Transfer Protocol

### FTP Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FTP - FILE TRANSFER PROTOCOL                     â”‚
â”‚                                                                     â”‚
â”‚    Protocol for transferring files between hosts                   â”‚
â”‚                                                                     â”‚
â”‚    KEY FEATURES:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ Uses TCP (reliable transfer needed)                      â”‚ â”‚
â”‚    â”‚  â€¢ TWO connections: Control + Data                          â”‚ â”‚
â”‚    â”‚  â€¢ Control connection: Port 21                              â”‚ â”‚
â”‚    â”‚  â€¢ Data connection: Port 20 (or dynamic)                    â”‚ â”‚
â”‚    â”‚  â€¢ Stateful (remembers current directory, etc.)            â”‚ â”‚
â”‚    â”‚  â€¢ Supports authentication (username/password)              â”‚ â”‚
â”‚    â”‚  â€¢ Text and binary transfer modes                           â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    FTP vs HTTP for file transfer:                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚    â”‚      FTP        â”‚      HTTP       â”‚                           â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
â”‚    â”‚ 2 connections   â”‚ 1 connection    â”‚                           â”‚
â”‚    â”‚ Stateful        â”‚ Stateless       â”‚                           â”‚
â”‚    â”‚ Bidirectional   â”‚ Primarily GET   â”‚                           â”‚
â”‚    â”‚ Directory ops   â”‚ No dir browsing â”‚                           â”‚
â”‚    â”‚ Resume support  â”‚ Range requests  â”‚                           â”‚
â”‚    â”‚ Less common now â”‚ More common     â”‚                           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FTP Dual Connection Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FTP DUAL CONNECTION MODEL                        â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [FTP Client]                        [FTP Server]           â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚    â”‚  â”‚ Control   â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚ Control   â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ Process   â”‚    CONTROL CONNECTION â”‚ Process   â”‚          â”‚ â”‚
â”‚    â”‚  â”‚           â”‚       (Port 21)       â”‚           â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ Commands  â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚ Responses â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ & replies â”‚                       â”‚           â”‚          â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚    â”‚       â”‚                                    â”‚                 â”‚ â”‚
â”‚    â”‚       â”‚                                    â”‚                 â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚    â”‚  â”‚ Data      â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚ Data      â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ Transfer  â”‚     DATA CONNECTION   â”‚ Transfer  â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ Process   â”‚       (Port 20)       â”‚ Process   â”‚          â”‚ â”‚
â”‚    â”‚  â”‚           â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚           â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ Files &   â”‚                       â”‚ Files &   â”‚          â”‚ â”‚
â”‚    â”‚  â”‚ listings  â”‚                       â”‚ listings  â”‚          â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    TWO CONNECTIONS:                                                 â”‚
â”‚                                                                     â”‚
â”‚    1. CONTROL CONNECTION (Port 21):                                â”‚
â”‚       â€¢ Persistent for entire session                              â”‚
â”‚       â€¢ Carries commands and responses                             â”‚
â”‚       â€¢ Text-based (like SMTP)                                     â”‚
â”‚       â€¢ Always initiated by client                                 â”‚
â”‚                                                                     â”‚
â”‚    2. DATA CONNECTION (Port 20 or dynamic):                        â”‚
â”‚       â€¢ Opened for each file transfer                              â”‚
â”‚       â€¢ Transfers actual file data                                 â”‚
â”‚       â€¢ Closes after transfer complete                             â”‚
â”‚       â€¢ Direction depends on active/passive mode                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FTP Active vs Passive Mode

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FTP ACTIVE vs PASSIVE MODE                       â”‚
â”‚                                                                     â”‚
â”‚    ACTIVE MODE (default, problematic with firewalls):               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [Client]                              [Server]             â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â”€â”€â”€â”€ Control: Connect to port 21 â”€â”€â”€â–ºâ”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â”€â”€â”€â”€ PORT 192,168,1,5,10,20 â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚ â”‚
â”‚    â”‚      â”‚     (Client says: "Connect to me   â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚      at IP:port 192.168.1.5:2580") â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â—„â”€â”€â”€ Data: Server connects FROM â”€â”€â”€â”€â”€â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚           port 20 TO client port    â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  PROBLEM: Server initiates data connection TO client        â”‚ â”‚
â”‚    â”‚           Firewall/NAT often blocks incoming connections!   â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    PASSIVE MODE (firewall-friendly):                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [Client]                              [Server]             â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â”€â”€â”€â”€ Control: Connect to port 21 â”€â”€â”€â–ºâ”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â”€â”€â”€â”€ PASV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚ â”‚
â”‚    â”‚      â”‚     (Client says: "I'll connect     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚      to YOU for data")              â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â—„â”€â”€â”€ 227 (192,168,1,100,100,50) â”€â”€â”€â”€â”€â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚     (Server says: "Connect to me   â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚      at 192.168.1.100:25650")       â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚â”€â”€â”€â”€ Data: Client connects TO â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚ â”‚
â”‚    â”‚      â”‚           server's data port        â”‚                 â”‚ â”‚
â”‚    â”‚      â”‚                                     â”‚                 â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  SOLUTION: Client initiates BOTH connections                â”‚ â”‚
â”‚    â”‚            Works through most firewalls and NAT             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FTP Commands and Responses

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FTP COMMANDS                                     â”‚
â”‚                                                                     â”‚
â”‚    ACCESS CONTROL:                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚  USER username  - Specify username                          â”‚ â”‚
â”‚    â”‚  PASS password  - Specify password                          â”‚ â”‚
â”‚    â”‚  QUIT           - End session                               â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    FILE OPERATIONS:                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚  RETR filename  - Download file                             â”‚ â”‚
â”‚    â”‚  STOR filename  - Upload file                               â”‚ â”‚
â”‚    â”‚  DELE filename  - Delete file                               â”‚ â”‚
â”‚    â”‚  RNFR/RNTO     - Rename file                                â”‚ â”‚
â”‚    â”‚  LIST          - List directory contents                    â”‚ â”‚
â”‚    â”‚  NLST          - Name list only                             â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    DIRECTORY OPERATIONS:                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚  CWD dirname    - Change directory                          â”‚ â”‚
â”‚    â”‚  PWD            - Print working directory                   â”‚ â”‚
â”‚    â”‚  MKD dirname    - Make directory                            â”‚ â”‚
â”‚    â”‚  RMD dirname    - Remove directory                          â”‚ â”‚
â”‚    â”‚  CDUP           - Change to parent directory                â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    TRANSFER SETTINGS:                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚  TYPE A         - ASCII mode (text files)                   â”‚ â”‚
â”‚    â”‚  TYPE I         - Binary/Image mode                         â”‚ â”‚
â”‚    â”‚  PORT h,h,h,h,p,p - Active mode, specify client port       â”‚ â”‚
â”‚    â”‚  PASV           - Passive mode                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    RESPONSE CODES:                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚  1xx - Positive preliminary (expect another reply)          â”‚ â”‚
â”‚    â”‚  2xx - Positive completion (action successful)              â”‚ â”‚
â”‚    â”‚  3xx - Positive intermediate (need more info)               â”‚ â”‚
â”‚    â”‚  4xx - Transient negative (try again later)                 â”‚ â”‚
â”‚    â”‚  5xx - Permanent negative (don't retry)                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Examples:                                                   â”‚ â”‚
â”‚    â”‚  220 - Service ready                                        â”‚ â”‚
â”‚    â”‚  230 - User logged in                                       â”‚ â”‚
â”‚    â”‚  331 - Username OK, need password                           â”‚ â”‚
â”‚    â”‚  425 - Can't open data connection                           â”‚ â”‚
â”‚    â”‚  530 - Not logged in                                        â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. DHCP - Dynamic Host Configuration Protocol

### DHCP Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DHCP - DYNAMIC HOST CONFIGURATION                â”‚
â”‚                                                                     â”‚
â”‚    Automatically configure network settings for hosts             â”‚
â”‚                                                                     â”‚
â”‚    PROBLEM:                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Every host needs:                                          â”‚ â”‚
â”‚    â”‚  â€¢ IP address                                               â”‚ â”‚
â”‚    â”‚  â€¢ Subnet mask                                              â”‚ â”‚
â”‚    â”‚  â€¢ Default gateway                                          â”‚ â”‚
â”‚    â”‚  â€¢ DNS server addresses                                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Manual configuration for 1000 hosts? Nightmare!            â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    SOLUTION - DHCP:                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ Automatic IP address assignment                          â”‚ â”‚
â”‚    â”‚  â€¢ Centralized configuration                                â”‚ â”‚
â”‚    â”‚  â€¢ Supports address reuse (leasing)                         â”‚ â”‚
â”‚    â”‚  â€¢ Works immediately when host joins network                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Port 67 (server) and Port 68 (client)                      â”‚ â”‚
â”‚    â”‚  Uses UDP (fast, broadcast-based)                           â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    WHAT DHCP PROVIDES:                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Primary:                                                    â”‚ â”‚
â”‚    â”‚  â€¢ IP address                                               â”‚ â”‚
â”‚    â”‚  â€¢ Subnet mask                                              â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Additional options:                                         â”‚ â”‚
â”‚    â”‚  â€¢ Default gateway (router)                                 â”‚ â”‚
â”‚    â”‚  â€¢ DNS server addresses                                     â”‚ â”‚
â”‚    â”‚  â€¢ Domain name                                              â”‚ â”‚
â”‚    â”‚  â€¢ Lease duration                                           â”‚ â”‚
â”‚    â”‚  â€¢ NTP server                                               â”‚ â”‚
â”‚    â”‚  â€¢ And many more...                                         â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DHCP DORA Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DHCP DORA PROCESS                                â”‚
â”‚                                                                     â”‚
â”‚    D-O-R-A: Discover, Offer, Request, Acknowledge                  â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [New Client]                     [DHCP Server]             â”‚ â”‚
â”‚    â”‚  IP: 0.0.0.0                      IP: 192.168.1.1           â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  1. DHCP DISCOVER               â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Src: 0.0.0.0                    â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Dst: 255.255.255.255 (broadcast)â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  "Is there a DHCP server?"       â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  2. DHCP OFFER                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  "I can offer you 192.168.1.50"  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Subnet: 255.255.255.0           â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Gateway: 192.168.1.1            â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  DNS: 8.8.8.8                    â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Lease: 24 hours                 â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  3. DHCP REQUEST                â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  Dst: 255.255.255.255 (broadcast)â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  "I'll take that offer!"         â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  (Also informs other servers)    â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  4. DHCP ACK                    â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚  "Confirmed! It's yours."        â”‚                    â”‚ â”‚
â”‚    â”‚      â”‚                                  â”‚                    â”‚ â”‚
â”‚    â”‚  IP: 192.168.1.50                       â”‚                    â”‚ â”‚
â”‚    â”‚  Ready to communicate!                  â”‚                    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    WHY BROADCAST?                                                   â”‚
â”‚    â€¢ Client doesn't know server's IP yet                           â”‚
â”‚    â€¢ Client doesn't have an IP yet (can't receive unicast)         â”‚
â”‚                                                                     â”‚
â”‚    WHY REQUEST IS BROADCAST?                                        â”‚
â”‚    â€¢ Multiple DHCP servers might have offered                      â”‚
â”‚    â€¢ Broadcast tells other servers "I picked this one"             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### IP Address Leasing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DHCP LEASE MANAGEMENT                            â”‚
â”‚                                                                     â”‚
â”‚    Addresses are LEASED, not permanently assigned                  â”‚
â”‚                                                                     â”‚
â”‚    LEASE LIFECYCLE:                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Time 0                                                      â”‚ â”‚
â”‚    â”‚    â”‚  DORA complete, lease starts                           â”‚ â”‚
â”‚    â”‚    â”‚  Lease duration: e.g., 8 hours                         â”‚ â”‚
â”‚    â”‚    â–¼                                                         â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚  â”‚                    LEASE ACTIVE                      â”‚    â”‚ â”‚
â”‚    â”‚  â”‚              Client uses IP normally                 â”‚    â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â”‚  At T1 (50% = 4 hours):                                â”‚ â”‚
â”‚    â”‚    â”‚  Client tries to RENEW (unicast to server)             â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚    â”‚    â”‚  â”‚ Client: DHCP REQUEST (unicast)                  â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  â”‚ Server: DHCP ACK (new lease time)               â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â”‚  If renewal fails, at T2 (87.5% = 7 hours):            â”‚ â”‚
â”‚    â”‚    â”‚  Client tries REBIND (broadcast to any server)         â”‚ â”‚
â”‚    â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚    â”‚  If rebind fails at 100%:                              â”‚ â”‚
â”‚    â”‚    â–¼  Lease expires, client loses IP, starts DORA again     â”‚ â”‚
â”‚    â”‚  EXPIRED                                                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    LEASE TIMERS:                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  0%â”€â”€â”€â”€â”€â”€â”€â”€50%â”€â”€â”€â”€â”€â”€87.5%â”€â”€â”€â”€â”€â”€100%                         â”‚ â”‚
â”‚    â”‚  â”‚          â”‚         â”‚         â”‚                            â”‚ â”‚
â”‚    â”‚  Start     T1        T2      Expire                         â”‚ â”‚
â”‚    â”‚           Renew    Rebind                                   â”‚ â”‚
â”‚    â”‚         (unicast) (broadcast)                               â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  Example: 8-hour lease                                       â”‚ â”‚
â”‚    â”‚  â€¢ T1 = 4 hours: Try renewing with original server          â”‚ â”‚
â”‚    â”‚  â€¢ T2 = 7 hours: Broadcast to any DHCP server               â”‚ â”‚
â”‚    â”‚  â€¢ 8 hours: Lease expires, must get new IP                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    DHCP RELEASE:                                                    â”‚
â”‚    Client can voluntarily release IP before expiry                 â”‚
â”‚    (e.g., when shutting down properly)                             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DHCP Relay Agent

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DHCP RELAY AGENT                                 â”‚
â”‚                                                                     â”‚
â”‚    Problem: DHCP uses broadcast, which doesn't cross routers       â”‚
â”‚    Solution: DHCP Relay Agent forwards requests                    â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚    Subnet A                           Subnet B              â”‚ â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”‚
â”‚    â”‚  â”‚              â”‚               â”‚                      â”‚    â”‚ â”‚
â”‚    â”‚  â”‚  [Client]    â”‚               â”‚    [DHCP Server]     â”‚    â”‚ â”‚
â”‚    â”‚  â”‚              â”‚               â”‚    192.168.2.10      â”‚    â”‚ â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â”‚
â”‚    â”‚         â”‚                                  â”‚                 â”‚ â”‚
â”‚    â”‚         â”‚ Broadcast                        â”‚                 â”‚ â”‚
â”‚    â”‚         â–¼                                  â”‚                 â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚                 â”‚ â”‚
â”‚    â”‚    â”‚    ROUTER with      â”‚                 â”‚                 â”‚ â”‚
â”‚    â”‚    â”‚   DHCP RELAY AGENT  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚    â”‚    â”‚   192.168.1.1       â”‚                                   â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚ â”‚
â”‚    â”‚         â”‚                                                    â”‚ â”‚
â”‚    â”‚         â”‚ Unicast                                            â”‚ â”‚
â”‚    â”‚         â”‚ (converted from broadcast)                         â”‚ â”‚
â”‚    â”‚         â–¼                                                    â”‚ â”‚
â”‚    â”‚    [DHCP Server]                                             â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    RELAY AGENT OPERATION:                                           â”‚
â”‚    1. Receives broadcast DISCOVER on subnet A                      â”‚
â”‚    2. Inserts giaddr (gateway IP) = 192.168.1.1                   â”‚
â”‚    3. Forwards as unicast to DHCP server on subnet B               â”‚
â”‚    4. Server knows which subnet needs IP (from giaddr)            â”‚
â”‚    5. Relay forwards response back to client                       â”‚
â”‚                                                                     â”‚
â”‚    Benefits:                                                        â”‚
â”‚    â€¢ One DHCP server can serve multiple subnets                    â”‚
â”‚    â€¢ Centralized IP management                                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Summary Table

| Feature | FTP | DHCP |
|---------|-----|------|
| **Purpose** | File transfer | Auto configuration |
| **Transport** | TCP | UDP |
| **Ports** | 21 (control), 20 (data) | 67 (server), 68 (client) |
| **Connections** | 2 (control + data) | 1 |
| **Mode** | Client-server | Client-server |
| **Direction** | Client initiates | Client initiates |

| DHCP Step | Message | Direction | Purpose |
|-----------|---------|-----------|---------|
| 1 | DISCOVER | Clientâ†’Broadcast | Find servers |
| 2 | OFFER | Serverâ†’Client | Offer IP config |
| 3 | REQUEST | Clientâ†’Broadcast | Accept offer |
| 4 | ACK | Serverâ†’Client | Confirm assignment |

---

## â“ Quick Revision Questions

1. **Q:** Why does FTP use two connections?
   <details>
   <summary>Answer</summary>
   FTP uses two separate connections:
   
   **Control Connection (Port 21)**:
   - Persistent for entire session
   - Carries commands (USER, PASS, RETR, STOR)
   - Carries responses (status codes)
   - Text-based
   
   **Data Connection (Port 20 or dynamic)**:
   - Opened for each transfer
   - Carries actual file data
   - Carries directory listings
   - Closes after transfer
   
   **Benefits**:
   - Can send commands while transferring
   - Out-of-band control (abort transfer without losing session)
   - Cleaner protocol design
   </details>

2. **Q:** What is the difference between FTP active and passive mode?
   <details>
   <summary>Answer</summary>
   **Active Mode**:
   - Client: PORT command with client's IP:port
   - Server: Initiates data connection FROM port 20 TO client
   - **Problem**: Firewall/NAT blocks incoming connections
   
   **Passive Mode** (PASV):
   - Client: PASV command
   - Server: Responds with server's IP:port
   - Client: Initiates data connection TO server
   - **Solution**: Works through firewalls (client initiates both)
   
   Modern clients use passive mode by default.
   </details>

3. **Q:** What does DHCP DORA stand for?
   <details>
   <summary>Answer</summary>
   **D-O-R-A** process:
   
   1. **D**iscover: Client broadcasts "Any DHCP server?"
   2. **O**ffer: Server offers IP configuration
   3. **R**equest: Client broadcasts acceptance
   4. **A**cknowledge: Server confirms assignment
   
   All messages are UDP (ports 67/68)
   
   After DORA, client has:
   - IP address
   - Subnet mask
   - Default gateway
   - DNS servers
   - Lease duration
   </details>

4. **Q:** What is a DHCP lease and why is it needed?
   <details>
   <summary>Answer</summary>
   **Lease**: Temporary assignment of IP address
   
   **Why needed**:
   - Limited IP addresses available
   - Hosts join and leave network
   - Prevents IP exhaustion
   - Allows address reuse
   
   **Lease lifecycle**:
   - T1 (50%): Try renewal (unicast)
   - T2 (87.5%): Try rebind (broadcast)
   - Expiry (100%): Lose IP, restart DORA
   
   **DHCP RELEASE**: Client can return IP early when leaving network.
   </details>

5. **Q:** Why is the DHCP REQUEST message broadcast?
   <details>
   <summary>Answer</summary>
   Even though client already chose a server, REQUEST is broadcast because:
   
   1. **Multiple servers may have offered**:
      - Client might receive multiple OFFERs
      - Broadcast tells rejected servers "don't reserve that IP"
   
   2. **Client still has no valid IP**:
      - Can't send unicast without confirmed IP
      - Broadcasting is the only option
   
   3. **Informs all servers**:
      - Selected server sees acceptance
      - Other servers see rejection, release reserved IPs
   </details>

6. **Q:** What is a DHCP relay agent and when is it needed?
   <details>
   <summary>Answer</summary>
   **DHCP Relay Agent**: Router feature that forwards DHCP messages between subnets
   
   **When needed**:
   - DHCP server on different subnet
   - Broadcasts don't cross routers
   - Want centralized DHCP server
   
   **How it works**:
   1. Receives broadcast DISCOVER on local subnet
   2. Adds giaddr (gateway IP) to message
   3. Forwards as unicast to DHCP server
   4. Server uses giaddr to know which subnet
   5. Relay forwards response back to client
   
   **Benefit**: One DHCP server can serve multiple subnets
   </details>

---

## ğŸ”— Navigation

| Previous | Up | Next |
|----------|-----|------|
| [â† Email Protocols](04-email-protocols.md) | [Table of Contents](../README.md) | [Network Security â†’](../08-Network-Security/01-security-basics.md) |

---

*Â© 2025 Computer Networking Study Notes. For educational purposes.*
