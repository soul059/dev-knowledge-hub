# Chapter 8.4: SSL/TLS Protocol

[â† Back to Table of Contents](../README.md)

---

## ğŸ“š Chapter Overview

SSL (Secure Sockets Layer) and its successor TLS (Transport Layer Security) are cryptographic protocols that provide secure communication over networks. They are the foundation of HTTPS and secure virtually all web traffic today.

---

## ğŸ¯ Learning Objectives

- Understand the purpose and evolution of SSL/TLS
- Master the TLS handshake process
- Learn about certificates and Public Key Infrastructure
- Understand how HTTPS uses TLS for secure web browsing

---

## 1. SSL/TLS Overview

### Protocol Evolution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SSL/TLS EVOLUTION                                â”‚
â”‚                                                                     â”‚
â”‚    SSL 2.0 (1995) â”€â”€â–º SSL 3.0 (1996) â”€â”€â–º TLS 1.0 (1999)            â”‚
â”‚    [Deprecated]       [Deprecated]       [Deprecated]              â”‚
â”‚                                              â”‚                      â”‚
â”‚                                              â–¼                      â”‚
â”‚                                         TLS 1.1 (2006)             â”‚
â”‚                                         [Deprecated]               â”‚
â”‚                                              â”‚                      â”‚
â”‚                                              â–¼                      â”‚
â”‚                                         TLS 1.2 (2008)             â”‚
â”‚                                         [Still widely used]        â”‚
â”‚                                              â”‚                      â”‚
â”‚                                              â–¼                      â”‚
â”‚                                         TLS 1.3 (2018)             â”‚
â”‚                                         [Current standard]         â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚ IMPORTANT:                                                   â”‚ â”‚
â”‚    â”‚ â€¢ "SSL" is technically deprecated                           â”‚ â”‚
â”‚    â”‚ â€¢ People still say "SSL" but mean TLS                       â”‚ â”‚
â”‚    â”‚ â€¢ Use TLS 1.2 or TLS 1.3 only                               â”‚ â”‚
â”‚    â”‚ â€¢ TLS 1.3 is faster and more secure                         â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    TLS POSITION IN STACK:                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚        Application Layer                                    â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚ â”‚
â”‚    â”‚    â”‚  HTTP, FTP, SMTP, etc.  â”‚                              â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â”‚
â”‚    â”‚                â”‚                                             â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚ â”‚
â”‚    â”‚    â”‚         TLS             â”‚ â—„â”€â”€ Security Layer           â”‚ â”‚
â”‚    â”‚    â”‚  (Encryption, Auth)     â”‚                              â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â”‚
â”‚    â”‚                â”‚                                             â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚ â”‚
â”‚    â”‚    â”‚         TCP             â”‚                              â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â”‚
â”‚    â”‚                â”‚                                             â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚ â”‚
â”‚    â”‚    â”‚         IP              â”‚                              â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### What TLS Provides

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TLS SECURITY GOALS                               â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  1. CONFIDENTIALITY                                         â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚    â”‚     â”‚ "Hello"  â”€â–º  [Encrypt]  â”€â–º  "x7#kL9@..."     â”‚        â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚    â”‚     â€¢ Data encrypted using symmetric cipher                 â”‚ â”‚
â”‚    â”‚     â€¢ Only sender and receiver can read                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  2. INTEGRITY                                                â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚    â”‚     â”‚ Data + MAC (Message Authentication Code)     â”‚        â”‚ â”‚
â”‚    â”‚     â”‚ If data modified, MAC verification fails    â”‚        â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚    â”‚     â€¢ Detect any tampering during transit                   â”‚ â”‚
â”‚    â”‚     â€¢ HMAC used for integrity                               â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  3. AUTHENTICATION                                           â”‚ â”‚
â”‚    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚    â”‚     â”‚ Server presents CERTIFICATE                  â”‚        â”‚ â”‚
â”‚    â”‚     â”‚ Certificate verified by trusted CA          â”‚        â”‚ â”‚
â”‚    â”‚     â”‚ âœ“ "I'm really google.com"                   â”‚        â”‚ â”‚
â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚    â”‚     â€¢ Prove server identity                                 â”‚ â”‚
â”‚    â”‚     â€¢ Client auth optional (mutual TLS)                     â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Certificates and PKI

### Digital Certificates

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    X.509 CERTIFICATE                                â”‚
â”‚                                                                     â”‚
â”‚    A digital certificate binds identity to public key              â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚ â”‚
â”‚    â”‚  â•‘              DIGITAL CERTIFICATE                       â•‘  â”‚ â”‚
â”‚    â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Subject: www.example.com                              â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Issuer: DigiCert Inc (Certificate Authority)          â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Public Key: MIIBIjANBgkqhk...                         â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Valid From: 2024-01-01                                â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Valid To:   2025-01-01                                â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Serial Number: 0x1234567890ABCDEF                     â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  Signature Algorithm: SHA256withRSA                    â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  CA's Digital Signature                                â•‘  â”‚ â”‚
â”‚    â”‚  â•‘  (Signed with CA's private key)                        â•‘  â”‚ â”‚
â”‚    â”‚  â•‘                                                        â•‘  â”‚ â”‚
â”‚    â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    CERTIFICATE PURPOSE:                                             â”‚
â”‚    â€¢ Proves "www.example.com" owns this public key                 â”‚
â”‚    â€¢ Signed by trusted Certificate Authority                       â”‚
â”‚    â€¢ Client can verify signature using CA's public key             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Certificate Chain of Trust

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CERTIFICATE CHAIN (PKI)                          â”‚
â”‚                                                                     â”‚
â”‚    PKI = Public Key Infrastructure                                 â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚            ROOT CA                                          â”‚ â”‚
â”‚    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚ â”‚
â”‚    â”‚       â”‚ Root Cert   â”‚  â—„â”€â”€ Self-signed                     â”‚ â”‚
â”‚    â”‚       â”‚ (DigiCert)  â”‚      Pre-installed in OS/Browser     â”‚ â”‚
â”‚    â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                       â”‚ â”‚
â”‚    â”‚              â”‚ Signs                                        â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚        INTERMEDIATE CA                                       â”‚ â”‚
â”‚    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚ â”‚
â”‚    â”‚       â”‚ Intermediateâ”‚  â—„â”€â”€ Signed by Root                   â”‚ â”‚
â”‚    â”‚       â”‚ Certificate â”‚      Adds layer of security          â”‚ â”‚
â”‚    â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                       â”‚ â”‚
â”‚    â”‚              â”‚ Signs                                        â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚         END ENTITY                                           â”‚ â”‚
â”‚    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚ â”‚
â”‚    â”‚       â”‚ Server Cert â”‚  â—„â”€â”€ Signed by Intermediate          â”‚ â”‚
â”‚    â”‚       â”‚ (website)   â”‚      www.example.com                  â”‚ â”‚
â”‚    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    VERIFICATION PROCESS:                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  [Browser receives server certificate]                      â”‚ â”‚
â”‚    â”‚              â”‚                                               â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚  [Check: Is certificate expired?] â”€â”€Yesâ”€â”€â–º âœ— Reject         â”‚ â”‚
â”‚    â”‚              â”‚ No                                            â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚  [Check: Does domain match?] â”€â”€â”€â”€â”€â”€â”€Yesâ”€â”€â–º âœ— Reject         â”‚ â”‚
â”‚    â”‚              â”‚ Yes                                           â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚  [Verify signature with issuer's public key]                â”‚ â”‚
â”‚    â”‚              â”‚                                               â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚  [Follow chain up to trusted root]                          â”‚ â”‚
â”‚    â”‚              â”‚                                               â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚  [Root in trust store?] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Noâ”€â”€â–º âœ— Reject          â”‚ â”‚
â”‚    â”‚              â”‚ Yes                                           â”‚ â”‚
â”‚    â”‚              â–¼                                               â”‚ â”‚
â”‚    â”‚         âœ“ TRUSTED                                            â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. TLS Handshake

### TLS 1.2 Handshake

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TLS 1.2 HANDSHAKE                                â”‚
â”‚                                                                     â”‚
â”‚    2 Round Trips (2-RTT) before encrypted data                     â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚    CLIENT                              SERVER                â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  1. ClientHello                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ TLS version                    â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Client random                  â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Cipher suites                  â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  2. ServerHello                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”€â”              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ TLS version                    â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Server random                  â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Chosen cipher                  â”‚   â”‚ RTT 1        â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  3. Certificate                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Server's certificate           â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  4. ServerHelloDone               â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”€â”˜              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  [Client verifies certificate]    â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  5. ClientKeyExchange             â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚  â”€â”              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Pre-master secret (encrypted)  â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  6. ChangeCipherSpec              â”‚   â”‚ RTT 2        â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  7. Finished                      â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  (Encrypted with session key)     â”‚  â”€â”˜              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  8. ChangeCipherSpec              â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  9. Finished                      â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  ENCRYPTED APPLICATION DATA       â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    KEY DERIVATION:                                                  â”‚
â”‚    Pre-master + Client Random + Server Random                      â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â–¼                                         â”‚
â”‚                    Master Secret                                    â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â–¼                                         â”‚
â”‚                    Session Keys                                     â”‚
â”‚    (symmetric keys for encrypt/decrypt)                            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### TLS 1.3 Handshake (Improved)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TLS 1.3 HANDSHAKE                                â”‚
â”‚                                                                     â”‚
â”‚    Only 1 Round Trip (1-RTT) - 50% faster!                         â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚    CLIENT                              SERVER                â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  1. ClientHello                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚  â”€â”              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Key share (Diffie-Hellman)     â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Cipher suites                  â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  2. ServerHello                   â”‚   â”‚ 1 RTT        â”‚ â”‚
â”‚    â”‚       â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Key share                      â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Encrypted Extensions           â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Certificate                    â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚  â€¢ Finished                       â”‚   â”‚              â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚  â”€â”˜              â”‚ â”‚
â”‚    â”‚       â”‚  [Keys derived immediately]       â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  3. Finished                      â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚                                   â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  ENCRYPTED APPLICATION DATA       â”‚                  â”‚ â”‚
â”‚    â”‚       â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    TLS 1.3 IMPROVEMENTS:                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  â€¢ 1-RTT instead of 2-RTT (faster)                          â”‚ â”‚
â”‚    â”‚  â€¢ 0-RTT for resumed connections (even faster)              â”‚ â”‚
â”‚    â”‚  â€¢ Removed weak cipher suites                               â”‚ â”‚
â”‚    â”‚  â€¢ Forward secrecy mandatory (Diffie-Hellman)               â”‚ â”‚
â”‚    â”‚  â€¢ Simplified handshake                                     â”‚ â”‚
â”‚    â”‚  â€¢ Better encryption of handshake messages                  â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. HTTPS Operation

### How HTTPS Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HTTPS = HTTP + TLS                               â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚    â”‚    â”‚                    HTTP                            â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  GET /login HTTP/1.1                               â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  Host: bank.com                                    â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  Cookie: session=abc123                            â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚    â”‚                          â”‚                                   â”‚ â”‚
â”‚    â”‚                          â–¼                                   â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚    â”‚    â”‚                    TLS                             â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  Encrypt entire HTTP request                       â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  Output: x7Kp#mL9@qW2... (ciphertext)              â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚    â”‚                          â”‚                                   â”‚ â”‚
â”‚    â”‚                          â–¼                                   â”‚ â”‚
â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚    â”‚    â”‚                    TCP                             â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â”‚  Port 443 (HTTPS default)                          â”‚   â”‚ â”‚
â”‚    â”‚    â”‚                                                     â”‚   â”‚ â”‚
â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    WHAT'S ENCRYPTED:                                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  âœ“ URL path (/login, /account, etc.)                        â”‚ â”‚
â”‚    â”‚  âœ“ Query parameters (?user=john)                            â”‚ â”‚
â”‚    â”‚  âœ“ HTTP headers (cookies, auth tokens)                      â”‚ â”‚
â”‚    â”‚  âœ“ Request/response body                                    â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  âœ— Domain name (visible via SNI)                            â”‚ â”‚
â”‚    â”‚  âœ— IP addresses (network layer)                             â”‚ â”‚
â”‚    â”‚  âœ— That you're using HTTPS (port 443)                       â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### HTTPS Connection Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HTTPS CONNECTION FLOW                            â”‚
â”‚                                                                     â”‚
â”‚    [Browser]                                         [Web Server]  â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  1. DNS: Resolve "bank.com"                      â”‚         â”‚
â”‚        â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º    â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  2. TCP: 3-way handshake (port 443)              â”‚         â”‚
â”‚        â”‚  â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º   â”‚         â”‚
â”‚        â”‚         SYN â†’ SYN-ACK â†’ ACK                      â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  3. TLS Handshake                                â”‚         â”‚
â”‚        â”‚  â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º   â”‚         â”‚
â”‚        â”‚         (Certificate verification)              â”‚         â”‚
â”‚        â”‚         (Key exchange)                          â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚        â”‚  â”‚ At this point:                              â”‚ â”‚         â”‚
â”‚        â”‚  â”‚ â€¢ Server identity verified                  â”‚ â”‚         â”‚
â”‚        â”‚  â”‚ â€¢ Encryption keys established               â”‚ â”‚         â”‚
â”‚        â”‚  â”‚ â€¢ Secure channel ready                      â”‚ â”‚         â”‚
â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  4. Encrypted HTTP Request                       â”‚         â”‚
â”‚        â”‚  â•â•â•â•â•â•â•â•â•â•â•[ENCRYPTED]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º   â”‚         â”‚
â”‚        â”‚     GET /account HTTP/1.1                        â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  5. Encrypted HTTP Response                      â”‚         â”‚
â”‚        â”‚  â—„â•â•â•â•â•â•â•â•â•â•[ENCRYPTED]â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚         â”‚
â”‚        â”‚     200 OK                                       â”‚         â”‚
â”‚        â”‚     <html>Your account...</html>                 â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â”‚  6. Connection continues encrypted...            â”‚         â”‚
â”‚        â”‚                                                  â”‚         â”‚
â”‚        â–¼                                                  â–¼         â”‚
â”‚                                                                     â”‚
â”‚    BROWSER SECURITY INDICATORS:                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  ğŸ”’ https://bank.com/account                                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  ğŸ”’ = Valid certificate, secure connection                  â”‚ â”‚
â”‚    â”‚  âš ï¸ = Certificate issue (expired, wrong domain)             â”‚ â”‚
â”‚    â”‚  âŒ = Not secure (HTTP only)                                â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Cipher Suites

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TLS CIPHER SUITE                                 â”‚
â”‚                                                                     â”‚
â”‚    A cipher suite specifies algorithms for each security need     â”‚
â”‚                                                                     â”‚
â”‚    Example: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384                   â”‚
â”‚                                                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â”‚  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384                       â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â”‚        â”‚   â”‚   â”‚    â”‚                        â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â”‚        â”‚   â”‚   â”‚    â””â”€â–º Hash: SHA-384        â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â”‚        â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â–º Mode: GCM (AEAD)     â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Key size: 256-bit    â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Cipher: AES          â”‚ â”‚
â”‚    â”‚   â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Auth: RSA            â”‚ â”‚
â”‚    â”‚   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Key Exchange: ECDHE  â”‚ â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Protocol: TLS        â”‚ â”‚
â”‚    â”‚                                                              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    COMPONENTS:                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚ Component        â”‚ Purpose                                   â”‚ â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚    â”‚ Key Exchange     â”‚ How to exchange keys                     â”‚ â”‚
â”‚    â”‚ (ECDHE)          â”‚ Ephemeral = forward secrecy              â”‚ â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚    â”‚ Authentication   â”‚ How to authenticate server               â”‚ â”‚
â”‚    â”‚ (RSA)            â”‚ Using RSA certificates                   â”‚ â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚    â”‚ Encryption       â”‚ How to encrypt data                      â”‚ â”‚
â”‚    â”‚ (AES-256-GCM)    â”‚ Symmetric cipher for bulk data          â”‚ â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚    â”‚ MAC/Hash         â”‚ How to verify integrity                  â”‚ â”‚
â”‚    â”‚ (SHA-384)        â”‚ GCM includes authentication              â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                     â”‚
â”‚    TLS 1.3 CIPHER SUITES (simplified):                              â”‚
â”‚    â€¢ TLS_AES_256_GCM_SHA384                                        â”‚
â”‚    â€¢ TLS_CHACHA20_POLY1305_SHA256                                  â”‚
â”‚    â€¢ TLS_AES_128_GCM_SHA256                                        â”‚
â”‚    (Key exchange always ECDHE, removed weak options)               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Summary Table

| Protocol | Status | RTT | Features |
|----------|--------|-----|----------|
| **SSL 3.0** | Deprecated | - | Vulnerable (POODLE) |
| **TLS 1.0/1.1** | Deprecated | 2 | Weak ciphers |
| **TLS 1.2** | Supported | 2 | Widely used, secure |
| **TLS 1.3** | Recommended | 1 | Fastest, most secure |

| Component | TLS 1.2 | TLS 1.3 |
|-----------|---------|---------|
| **Handshake** | 2-RTT | 1-RTT |
| **Key Exchange** | Various | ECDHE only |
| **Forward Secrecy** | Optional | Mandatory |
| **Weak Ciphers** | Allowed | Removed |

| Certificate Level | Verification | Use Case |
|-------------------|--------------|----------|
| **DV** (Domain) | Domain ownership | Basic sites |
| **OV** (Organization) | Company verified | Business |
| **EV** (Extended) | Full verification | Banks, e-commerce |

---

## â“ Quick Revision Questions

1. **Q:** What is the purpose of TLS?
   <details>
   <summary>Answer</summary>
   **TLS provides three security goals**:
   
   1. **Confidentiality**: Encrypts data
   2. **Integrity**: Detects tampering (MAC)
   3. **Authentication**: Verifies server identity (certificates)
   
   TLS sits between application and transport layer, securing protocols like HTTP (â†’HTTPS), SMTP (â†’SMTPS).
   </details>

2. **Q:** How does the certificate chain of trust work?
   <details>
   <summary>Answer</summary>
   **Certificate Chain**:
   
   1. **Root CA**: Self-signed, pre-installed in browsers/OS
   2. **Intermediate CA**: Signed by Root CA
   3. **End Entity**: Server cert signed by Intermediate
   
   **Verification**:
   - Browser receives server certificate
   - Verifies signature using issuer's public key
   - Follows chain up to root
   - Root must be in trusted store
   
   If any step fails â†’ certificate rejected.
   </details>

3. **Q:** Compare TLS 1.2 and TLS 1.3 handshakes.
   <details>
   <summary>Answer</summary>
   **TLS 1.2**:
   - 2 round trips (2-RTT)
   - Client sends hello, waits for server response
   - Then key exchange, then finished
   
   **TLS 1.3**:
   - 1 round trip (1-RTT)
   - Key share sent with ClientHello
   - Keys derived immediately after ServerHello
   - 0-RTT possible for resumed connections
   
   TLS 1.3 is 50% faster to establish connection.
   </details>

4. **Q:** What is a cipher suite?
   <details>
   <summary>Answer</summary>
   **Cipher Suite** = set of algorithms for:
   
   Example: `TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384`
   
   - **Key Exchange** (ECDHE): How to share keys
   - **Authentication** (RSA): How to verify server
   - **Encryption** (AES-256-GCM): How to encrypt data
   - **Hash/MAC** (SHA-384): How to verify integrity
   
   Client offers list, server chooses one both support.
   </details>

5. **Q:** What does HTTPS encrypt and not encrypt?
   <details>
   <summary>Answer</summary>
   **Encrypted**:
   - URL path (/page/login)
   - Query parameters (?id=123)
   - HTTP headers (cookies, auth)
   - Request/response body
   
   **NOT Encrypted**:
   - Domain name (SNI reveals it)
   - IP addresses
   - Port (443 visible)
   - That connection exists
   
   Attacker knows you visited bank.com, not what you did there.
   </details>

6. **Q:** What is forward secrecy and why is it important?
   <details>
   <summary>Answer</summary>
   **Forward Secrecy** (Perfect Forward Secrecy):
   
   Even if server's private key is compromised later, past sessions remain secure.
   
   **How it works**:
   - Use ephemeral (temporary) keys for each session
   - Diffie-Hellman key exchange (ECDHE)
   - Session keys not derived from long-term key
   
   **Without forward secrecy**:
   - Attacker records encrypted traffic
   - Later steals server's private key
   - Can decrypt all past sessions!
   
   TLS 1.3 mandates forward secrecy (ECDHE only).
   </details>

---

## ğŸ”— Navigation

| Previous | Up | Next |
|----------|-----|------|
| [â† Firewalls & VPNs](03-firewalls-vpn.md) | [Table of Contents](../README.md) | [Wireless Basics â†’](../09-Wireless-Networks/01-wireless-basics.md) |

---

*Â© 2025 Computer Networking Study Notes. For educational purposes.*
